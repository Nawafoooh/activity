<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام متابعة معايير الإدارة المدرسية</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .completed { color: #27ae60; }
        .in-progress { color: #f39c12; }
        .not-started { color: #e74c3c; }
        .total { color: #3498db; }

        .controls {
            padding: 20px 30px;
            background: white;
            border-bottom: 1px solid #eee;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box, .filter-select {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .search-box:focus, .filter-select:focus {
            outline: none;
            border-color: #3498db;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .indicator-section {
            margin: 30px;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .indicator-header {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            padding: 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .indicator-header:hover {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        }

        .indicator-title {
            font-size: 1.3rem;
            font-weight: bold;
        }

        .indicator-progress {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .progress-bar {
            width: 150px;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #27ae60;
            transition: width 0.3s ease;
        }

        .toggle-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .indicator-content {
            display: none;
            padding: 0;
        }

        .indicator-content.active {
            display: block;
        }

        .evidence-grid {
            display: grid;
            gap: 1px;
            background: #e9ecef;
        }

        .evidence-item {
            background: white;
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr auto auto auto auto;
            gap: 15px;
            align-items: center;
            transition: all 0.3s ease;
        }

        .evidence-item:hover {
            background: #f8f9fa;
        }

        .evidence-text {
            font-weight: 500;
            color: #2c3e50;
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            min-width: 80px;
        }

        .status-completed {
            background: #d4edda;
            color: #155724;
        }

        .status-in-progress {
            background: #fff3cd;
            color: #856404;
        }

        .status-not-started {
            background: #f8d7da;
            color: #721c24;
        }

        .date-input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 12px;
        }

        .action-select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 12px;
            min-width: 120px;
        }

        .notes-input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 12px;
            min-width: 150px;
            resize: horizontal;
        }

        .export-section {
            padding: 30px;
            background: #f8f9fa;
            text-align: center;
        }

        .export-btn {
            background: #e74c3c;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .evidence-item {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>🏫 نظام متابعة معايير الإدارة المدرسية</h1>
            <p>فريق التميز - معايير التقويم والاعتماد المدرسي</p>
        </div>

        <!-- Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number total" id="totalCount">0</div>
                <div>إجمالي الشواهد</div>
            </div>
            <div class="stat-card">
                <div class="stat-number completed" id="completedCount">0</div>
                <div>مكتمل</div>
            </div>
            <div class="stat-card">
                <div class="stat-number in-progress" id="inProgressCount">0</div>
                <div>قيد التنفيذ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number not-started" id="notStartedCount">0</div>
                <div>لم يبدأ</div>
            </div>
        </div>

        <!-- Controls -->
        <div class="controls">
            <input type="text" class="search-box" id="searchBox" placeholder="🔍 البحث في الشواهد...">
            <select class="filter-select" id="statusFilter">
                <option value="">جميع الحالات</option>
                <option value="completed">مكتمل</option>
                <option value="in-progress">قيد التنفيذ</option>
                <option value="not-started">لم يبدأ</option>
            </select>
            <button class="btn btn-primary" onclick="saveProgress()">💾 حفظ التقدم</button>
            <button class="btn btn-primary" onclick="exportReport()">📊 تصدير التقرير</button>
        </div>

        <!-- Main Content -->
        <div id="indicatorsContainer">
            <!-- Indicators will be generated by JavaScript -->
        </div>

        <!-- Export Section -->
        <div class="export-section">
            <h3 style="margin-bottom: 20px;">📈 تصدير التقارير</h3>
            <button class="export-btn" onclick="exportExcel()">📋 Excel</button>
            <button class="export-btn" onclick="exportPDF()">📄 PDF</button>
            <button class="export-btn" onclick="printReport()">🖨️ طباعة</button>
        </div>
    </div>

    <script>
        // Data structure for all indicators and evidence
        const indicators = [
            {
                id: "1-1-1-1",
                title: "تضع المدرسة خطة تشغيلية مكتملة العناصر، وفق أهداف تطويرية محددة",
                evidence: [
                    "توجد خطة تشغيلية",
                    "تتضمن الخطة أهداف تطويرية",
                    "تتضمن الخطة برامج ومبادرات وفق جدول زمني",
                    "توجد بالخطة أدوار ومسؤوليات محددة",
                    "توجد بالخطة مؤشرات أداء لتحقق الأهداف"
                ]
            },
            {
                id: "2-1-1-1",
                title: "تتابع المدرسة تنفيذ خطتها وتطورها بما يضمن تحقيق أهدافها",
                evidence: [
                    "تتابع المدرسة تنفيذ الأنشطة والبرامج وفق الخطة الزمنية",
                    "تتابع المدرسة تنفيذ الأنشطة والبرامج بأساليب متنوعة",
                    "يوجد إجراءات واضحة لمتابعة تنفيذ البرامج والأنشطة"
                ]
            }
        ];

        // Initialize evidence data
        let evidenceData = {};

        function initializeData() {
            indicators.forEach(indicator => {
                indicator.evidence.forEach((evidence, index) => {
                    const id = `${indicator.id}-${index}`;
                    if (!evidenceData[id]) {
                        evidenceData[id] = {
                            status: 'not-started',
                            followUpDate: '',
                            action: '',
                            notes: '',
                            responsible: 'فريق التميز'
                        };
                    }
                });
            });
        }

        function generateIndicatorHTML(indicator) {
            const completedCount = indicator.evidence.filter((_, index) => {
                const id = `${indicator.id}-${index}`;
                return evidenceData[id]?.status === 'completed';
            }).length;
            
            const progressPercentage = (completedCount / indicator.evidence.length) * 100;

            return `
                <div class="indicator-section" data-indicator="${indicator.id}">
                    <div class="indicator-header" onclick="toggleIndicator('${indicator.id}')">
                        <div class="indicator-title">
                            المؤشر ${indicator.id}: ${indicator.title}
                        </div>
                        <div class="indicator-progress">
                            <span>${completedCount}/${indicator.evidence.length}</span>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progressPercentage}%"></div>
                            </div>
                            <button class="toggle-btn" id="toggle-${indicator.id}">▼</button>
                        </div>
                    </div>
                    <div class="indicator-content" id="content-${indicator.id}">
                        <div class="evidence-grid">
                            ${indicator.evidence.map((evidence, index) => {
                                const id = `${indicator.id}-${index}`;
                                const data = evidenceData[id];
                                return `
                                    <div class="evidence-item" data-evidence-id="${id}">
                                        <div class="evidence-text">${evidence}</div>
                                        <div>
                                            <select class="action-select" onchange="updateStatus('${id}', this.value)">
                                                <option value="not-started" ${data.status === 'not-started' ? 'selected' : ''}>لم يبدأ</option>
                                                <option value="in-progress" ${data.status === 'in-progress' ? 'selected' : ''}>قيد التنفيذ</option>
                                                <option value="completed" ${data.status === 'completed' ? 'selected' : ''}>مكتمل</option>
                                            </select>
                                        </div>
                                        <div>
                                            <input type="date" class="date-input" value="${data.followUpDate}" 
                                                   onchange="updateFollowUpDate('${id}', this.value)">
                                        </div>
                                        <div>
                                            <select class="action-select" onchange="updateAction('${id}', this.value)">
                                                <option value="">اختر الإجراء</option>
                                                <option value="prepare-document" ${data.action === 'prepare-document' ? 'selected' : ''}>إعداد وثيقة</option>
                                                <option value="collect-evidence" ${data.action === 'collect-evidence' ? 'selected' : ''}>جمع الشواهد</option>
                                                <option value="implement-activity" ${data.action === 'implement-activity' ? 'selected' : ''}>تنفيذ نشاط</option>
                                            </select>
                                        </div>
                                        <div>
                                            <input type="text" class="notes-input" placeholder="ملاحظات..." 
                                                   value="${data.notes}" onchange="updateNotes('${id}', this.value)">
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderIndicators() {
            const container = document.getElementById('indicatorsContainer');
            container.innerHTML = indicators.map(generateIndicatorHTML).join('');
            updateStatistics();
        }

        function toggleIndicator(indicatorId) {
            const content = document.getElementById(`content-${indicatorId}`);
            const toggleBtn = document.getElementById(`toggle-${indicatorId}`);
            
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                toggleBtn.textContent = '▼';
            } else {
                content.classList.add('active');
                toggleBtn.textContent = '▲';
            }
        }

        function updateStatus(evidenceId, status) {
            evidenceData[evidenceId].status = status;
            updateStatistics();
            saveToLocalStorage();
            renderIndicators();
        }

        function updateFollowUpDate(evidenceId, date) {
            evidenceData[evidenceId].followUpDate = date;
            saveToLocalStorage();
        }

        function updateAction(evidenceId, action) {
            evidenceData[evidenceId].action = action;
            saveToLocalStorage();
        }

        function updateNotes(evidenceId, notes) {
            evidenceData[evidenceId].notes = notes;
            saveToLocalStorage();
        }

        function updateStatistics() {
            const total = Object.keys(evidenceData).length;
            const completed = Object.values(evidenceData).filter(item => item.status === 'completed').length;
            const inProgress = Object.values(evidenceData).filter(item => item.status === 'in-progress').length;
            const notStarted = Object.values(evidenceData).filter(item => item.status === 'not-started').length;

            document.getElementById('totalCount').textContent = total;
            document.getElementById('completedCount').textContent = completed;
            document.getElementById('inProgressCount').textContent = inProgress;
            document.getElementById('notStartedCount').textContent = notStarted;
        }

        function saveToLocalStorage() {
            localStorage.setItem('schoolEvidenceData', JSON.stringify(evidenceData));
        }

        function loadFromLocalStorage() {
            const saved = localStorage.getItem('schoolEvidenceData');
            if (saved) {
                evidenceData = JSON.parse(saved);
            }
        }

        function saveProgress() {
            saveToLocalStorage();
            alert('تم حفظ التقدم بنجاح! ✅');
        }

        function exportReport() {
            let report = "تقرير متابعة معايير الإدارة المدرسية\n";
            report += "=" .repeat(50) + "\n\n";
            
            indicators.forEach(indicator => {
                report += `المؤشر ${indicator.id}: ${indicator.title}\n`;
                report += "-".repeat(40) + "\n";
                
                indicator.evidence.forEach((evidence, index) => {
                    const id = `${indicator.id}-${index}`;
                    const data = evidenceData[id];
                    const statusText = {
                        'completed': 'مكتمل',
                        'in-progress': 'قيد التنفيذ',
                        'not-started': 'لم يبدأ'
                    };
                    
                    report += `${index + 1}. ${evidence}\n`;
                    report += `   الحالة: ${statusText[data.status]}\n`;
                    if (data.followUpDate) report += `   تاريخ المتابعة: ${data.followUpDate}\n`;
                    if (data.action) report += `   الإجراء: ${data.action}\n`;
                    if (data.notes) report += `   ملاحظات: ${data.notes}\n`;
                    report += "\n";
                });
                report += "\n";
            });

            const blob = new Blob([report], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'تقرير_معايير_الإدارة_المدرسية.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        function exportExcel() {
            alert('سيتم تصدير التقرير إلى Excel قريباً! 📊');
        }

        function exportPDF() {
            alert('سيتم تصدير التقرير إلى PDF قريباً! 📄');
        }

        function printReport() {
            window.print();
        }

        // Initialize the application
        function initApp() {
            initializeData();
            loadFromLocalStorage();
            renderIndicators();
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
