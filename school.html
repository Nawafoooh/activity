<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ - Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Tajawal', Arial, sans-serif;
            background: linear-gradient(135deg, #e8f4f8 0%, #f0f8ff 50%, #e6f3ff 100%);
            min-height: 100vh;
            color: #2c3e50;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 30px rgba(0,0,0,0.1);
        }
        
        .header {
            background: linear-gradient(135deg, #2c6470 0%, #4a90a4 100%);
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="40" r="1.5" fill="rgba(255,255,255,0.1)"/><circle cx="40" cy="80" r="1" fill="rgba(255,255,255,0.1)"/></svg>');
            pointer-events: none;
        }
        
        .header h1 {
            font-size: 2em;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            position: relative;
            z-index: 1;
        }
        
        .school-info {
            font-size: 1.2em;
            font-weight: 500;
            margin-bottom: 15px;
            color: #b8dce6;
            position: relative;
            z-index: 1;
        }
        
        .management-info {
            background: rgba(255, 255, 255, 0.15);
            padding: 10px 20px;
            border-radius: 25px;
            display: inline-block;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 1;
        }
        
        .activities-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0;
            margin: 40px 20px;
        }
        
        .activity-card {
            background: linear-gradient(135deg, #4a90a4, #2c6470);
            color: white;
            padding: 40px 20px;
            text-align: center;
            font-size: 1.1em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .activity-card:nth-child(odd) {
            background: linear-gradient(135deg, #5ba3b8, #4a90a4);
        }
        
        .activity-card:nth-child(even) {
            background: linear-gradient(135deg, #3d7485, #2c6470);
        }
        
        .activity-card:nth-child(3n) {
            background: linear-gradient(135deg, #6bb6c9, #5ba3b8);
        }
        
        .activity-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: all 0.6s ease;
        }
        
        .activity-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }
        
        .activity-card:hover::before {
            left: 100%;
        }
        
        .form-section {
            background: linear-gradient(135deg, #f8fbfc, #ffffff);
            padding: 40px 20px;
            border-top: 3px solid #4a90a4;
            box-shadow: 0 -2px 10px rgba(74, 144, 164, 0.05);
        }
        
        .form-title {
            text-align: center;
            font-size: 1.6em;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 30px;
            padding: 15px;
            background: linear-gradient(135deg, #e8f4f8, #f0f8ff);
            border-radius: 10px;
            border-left: 4px solid #4a90a4;
            box-shadow: 0 2px 8px rgba(74, 144, 164, 0.1);
        }

        .tab-navigation {
            display: flex;
            background: linear-gradient(135deg, #e8f4f8, #f0f8ff);
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(74, 144, 164, 0.1);
        }

        .tab-btn {
            flex: 1;
            background: transparent;
            border: none;
            padding: 15px 20px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            color: #2c6470;
            transition: all 0.3s ease;
            position: relative;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #4a90a4, #2c6470);
            color: white;
        }

        .tab-btn:hover:not(.active) {
            background: rgba(74, 144, 164, 0.1);
        }

        .hidden {
            display: none !important;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 30px;
            border: none;
            width: 60%;
            max-width: 500px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            animation: fadeIn 0.3s ease-in;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover,
        .close:focus {
            color: #2c6470;
        }

        .report-options {
            display: grid;
            gap: 20px;
            margin-top: 30px;
        }

        .report-option {
            background: linear-gradient(135deg, #4a90a4, #2c6470);
            color: white;
            padding: 20px;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            font-size: 1.1em;
            font-weight: 500;
            transition: all 0.3s ease;
            border: none;
        }

        .report-option:hover {
            background: linear-gradient(135deg, #357a8a, #1e4f56);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(74, 144, 164, 0.4);
        }

        .modal h2 {
            text-align: center;
            color: #2c6470;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            font-weight: 500;
            color: #34495e;
            margin-bottom: 8px;
            font-size: 0.95em;
        }
        
        .form-group input,
        .form-group select {
            padding: 12px;
            border: 2px solid #e8f4f8;
            border-radius: 6px;
            font-family: inherit;
            font-size: 0.95em;
            transition: all 0.3s ease;
            background: white;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4a90a4;
            box-shadow: 0 0 0 3px rgba(74, 144, 164, 0.1);
        }
        
        .large-field {
            grid-column: 1 / -1;
        }
        
        .large-field textarea {
            min-height: 100px;
            padding: 12px;
            border: 2px solid #e8f4f8;
            border-radius: 6px;
            font-family: inherit;
            font-size: 0.95em;
            resize: vertical;
            background: white;
        }
        
        .large-field textarea:focus {
            outline: none;
            border-color: #4a90a4;
            box-shadow: 0 0 0 3px rgba(74, 144, 164, 0.1);
        }

        /* Evidence Upload Section */
        .evidence-section {
            background: linear-gradient(135deg, #f8fbfc, #ffffff);
            border: 2px dashed #4a90a4;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .evidence-section:hover {
            border-color: #2c6470;
            background: linear-gradient(135deg, #e8f4f8, #f0f8ff);
        }

        .evidence-section.dragover {
            border-color: #27ae60;
            background: linear-gradient(135deg, #e8f8f5, #f0fdf4);
        }

        .upload-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            padding: 20px;
        }

        .upload-icon {
            font-size: 3em;
            color: #4a90a4;
            margin-bottom: 10px;
        }

        .upload-text {
            color: #2c6470;
            font-size: 1.1em;
            font-weight: 500;
        }

        .upload-subtext {
            color: #7f8c8d;
            font-size: 0.9em;
            margin-top: 5px;
        }

        .file-input {
            display: none;
        }

        .upload-btn {
            background: linear-gradient(135deg, #4a90a4, #2c6470);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .upload-btn:hover {
            background: linear-gradient(135deg, #357a8a, #1e4f56);
            transform: translateY(-2px);
        }

        .evidence-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
            padding: 20px;
            background: rgba(74, 144, 164, 0.05);
            border-radius: 8px;
        }

        .evidence-item {
            position: relative;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .evidence-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(74, 144, 164, 0.2);
        }

        .evidence-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .evidence-item:hover img {
            transform: scale(1.05);
        }

        .evidence-item .file-info {
            padding: 12px;
            text-align: center;
            background: linear-gradient(135deg, #f8fbfc, #ffffff);
        }

        .evidence-item .file-info > div:first-child {
            font-weight: 600;
            color: #2c6470;
            font-size: 0.9em;
            margin-bottom: 4px;
        }

        .evidence-item .remove-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(231, 76, 60, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            cursor: pointer;
            font-size: 1em;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .evidence-item .remove-btn:hover {
            background: rgba(192, 57, 43, 0.95);
            transform: scale(1.1);
        }

        .stats-dashboard {
            background: linear-gradient(135deg, #f8fbfc, #ffffff);
            border-radius: 15px;
            padding: 20px;
            margin: 20px;
            box-shadow: 0 5px 15px rgba(74, 144, 164, 0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-card {
            background: linear-gradient(135deg, #4a90a4, #2c6470);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-3px);
        }

        .stat-number {
            font-size: 2em;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .backup-controls {
            background: linear-gradient(135deg, #e8f4f8, #f0f8ff);
            border-radius: 10px;
            padding: 20px;
            margin: 20px;
            text-align: center;
        }

        .backup-btn {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.95em;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .backup-btn:hover {
            background: linear-gradient(135deg, #229954, #1e8449);
            transform: translateY(-2px);
        }

        .restore-btn {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .restore-btn:hover {
            background: linear-gradient(135deg, #e67e22, #d35400);
        }
        
        .action-buttons {
            text-align: center;
            margin: 30px 0;
        }
        
        .btn {
            background: linear-gradient(135deg, #4a90a4, #357a8a);
            color: white;
            padding: 14px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            margin: 0 10px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }
        
        .btn:hover {
            background: linear-gradient(135deg, #357a8a, #2c6470);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(74, 144, 164, 0.3);
        }
        
        .btn.secondary {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
        }
        
        .btn.secondary:hover {
            background: linear-gradient(135deg, #7f8c8d, #6c7b7d);
        }
        
        .footer {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            text-align: center;
            padding: 25px;
            margin-top: auto;
        }
        
        .footer p {
            margin: 5px 0;
            opacity: 0.9;
        }
        
        .footer .copyright {
            font-size: 0.9em;
            margin-top: 10px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        
        .footer .developer {
            color: #74b9ff;
            font-weight: 500;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #ecf0f1;
            border-radius: 3px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #4a90a4, #2c6470);
            width: 0%;
            transition: width 0.3s ease;
        }

        .form-validation-error {
            border-color: #e74c3c !important;
            box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.1) !important;
        }

        .validation-message {
            color: #e74c3c;
            font-size: 0.85em;
            margin-top: 5px;
            display: none;
        }
        
        @media (max-width: 768px) {
            .activities-grid {
                grid-template-columns: 1fr;
                margin: 20px 10px;
            }
            
            .activity-card {
                padding: 30px 15px;
                font-size: 1em;
            }
            
            .header h1 {
                font-size: 1.6em;
            }
            
            .form-section {
                padding: 30px 15px;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .btn {
                display: block;
                margin: 10px auto;
                width: fit-content;
            }

            .modal-content {
                width: 90%;
                margin: 20% auto;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .evidence-preview {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-in;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: scale(1);
            }
            to {
                opacity: 0;
                transform: scale(0.9);
            }
        }
        
        .slide-in-left {
            animation: slideInLeft 0.6s ease-out;
        }
        
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .slide-in-right {
            animation: slideInRight 0.6s ease-out;
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .loading {
            position: relative;
            overflow: hidden;
        }
        
        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Image Modal Styles */
        .image-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
        }

        .image-modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 90%;
            max-height: 90%;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .image-modal img {
            width: 100%;
            height: auto;
            display: block;
        }

        .image-modal-close {
            position: absolute;
            top: 15px;
            right: 25px;
            color: white;
            font-size: 35px;
            font-weight: bold;
            cursor: pointer;
            background: rgba(0,0,0,0.5);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .image-modal-close:hover {
            background: rgba(231, 76, 60, 0.8);
            transform: scale(1.1);
        }

        .image-modal-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.7));
            color: white;
            padding: 20px;
            text-align: center;
        }

        .image-modal-info .image-name {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .image-modal-info .image-details {
            font-size: 14px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header fade-in">
            <h1>Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ</h1>
            <div class="school-info">Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ</div>
            <div class="management-info">Ø±Ø§Ø¦Ø¯ Ø§Ù„Ù†Ø´Ø§Ø·: Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ø­Ø±Ø¨ÙŠ</div>
        </div>

        <!-- Statistics Dashboard -->
        <div class="stats-dashboard fade-in">
            <h3 style="color: #2c6470; margin-bottom: 15px; text-align: center;">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="total-activities">7</div>
                    <div class="stat-label">Ù…Ø¬Ø§Ù„Ø§Øª Ø§Ù„Ø£Ù†Ø´Ø·Ø©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="reports-generated">0</div>
                    <div class="stat-label">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ù†Ø´Ø£Ø©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="forms-completed">0</div>
                    <div class="stat-label">Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="evidence-uploaded">0</div>
                    <div class="stat-label">Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø©</div>
                </div>
            </div>
        </div>

        <!-- Backup Controls -->
        <div class="backup-controls">
            <h4 style="color: #2c6470; margin-bottom: 15px;">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h4>
            <button class="backup-btn" onclick="backupData()">ğŸ“ Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            <button class="backup-btn restore-btn" onclick="document.getElementById('restore-file').click()">ğŸ“‚ Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            <input type="file" id="restore-file" accept=".json" style="display: none;" onchange="restoreData(this)">
            <button class="backup-btn" onclick="exportAllData()">ğŸ“Š ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
        </div>
        
        <!-- Activities Grid -->
        <div class="activities-grid">
            <div class="activity-card slide-in-right loading" onclick="openActivity('Ù…Ø¬Ø§Ù„ Ø§Ù„Ø±ÙŠØ§Ø¶Ø© ÙˆØ§Ù„ØµØ­Ø©')">
                Ù…Ø¬Ø§Ù„ Ø§Ù„Ø±ÙŠØ§Ø¶Ø© ÙˆØ§Ù„ØµØ­Ø©
            </div>
            
            <div class="activity-card slide-in-left loading" onclick="openActivity('Ù…Ø¬Ø§Ù„ Ø§Ù„Ù…ÙˆØ§Ø·Ù†Ø© ÙˆØ§Ù„Ø­ÙŠØ§Ø©')">
                Ù…Ø¬Ø§Ù„ Ø§Ù„Ù…ÙˆØ§Ø·Ù†Ø© ÙˆØ§Ù„Ø­ÙŠØ§Ø©
            </div>
            
            <div class="activity-card slide-in-right loading" onclick="openActivity('Ù…Ø¬Ø§Ù„ Ø§Ù„Ø«Ù‚Ø§ÙØ© ÙˆØ§Ù„ÙÙ†ÙˆÙ†')">
                Ù…Ø¬Ø§Ù„ Ø§Ù„Ø«Ù‚Ø§ÙØ© ÙˆØ§Ù„ÙÙ†ÙˆÙ†
            </div>
            
            <div class="activity-card slide-in-left loading" onclick="openActivity('Ù…Ø¬Ø§Ù„ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„ÙƒØ´ÙÙŠ')">
                Ù…Ø¬Ø§Ù„ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„ÙƒØ´ÙÙŠ
            </div>
            
            <div class="activity-card slide-in-right loading" onclick="openActivity('Ù…Ø¬Ø§Ù„ Ø§Ù„Ø¹Ù„ÙˆÙ… ÙˆØ§Ù„ØªÙ‚Ù†ÙŠØ©')">
                Ù…Ø¬Ø§Ù„ Ø§Ù„Ø¹Ù„ÙˆÙ… ÙˆØ§Ù„ØªÙ‚Ù†ÙŠØ©
            </div>
            
            <div class="activity-card slide-in-left loading" onclick="openActivity('Ù…Ø¬Ø§Ù„ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ')">
                Ù…Ø¬Ø§Ù„ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ
            </div>
            
            <div class="activity-card slide-in-right loading" onclick="openActivity('Ù…Ø¬Ø§Ù„ Ø§Ù„Ø£ÙŠØ§Ù… ÙˆØ§Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª')">
                Ù…Ø¬Ø§Ù„ Ø§Ù„Ø£ÙŠØ§Ù… ÙˆØ§Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª
            </div>
            
            <div class="activity-card slide-in-left loading" onclick="openFinalReport()">
                Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù„Ø£Ù†Ø´Ø·Ø©
            </div>
        </div>
        
        <!-- Form Section -->
        <div class="form-section fade-in">
            <!-- Tab Navigation for Final Reports -->
            <div class="tab-navigation hidden" id="report-tabs">
                <button class="tab-btn active" onclick="switchTab('daily')">Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</button>
                <button class="tab-btn" onclick="switchTab('weekly')">Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</button>
                <button class="tab-btn" onclick="switchTab('monthly')">Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ</button>
            </div>

            <div class="form-title" id="form-title">Ù…Ø¬Ø§Ù„ Ø§Ù„Ø±ÙŠØ§Ø¶Ø© ÙˆØ§Ù„ØµØ­Ø©</div>
            
            <!-- Progress Bar -->
            <div class="progress-bar">
                <div class="progress-fill" id="form-progress"></div>
            </div>
            
            <!-- Activity Form -->
            <form class="form-grid" id="activity-form">
                <div class="form-group">
                    <label for="education-dept">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</label>
                    <input type="text" id="education-dept" placeholder="Ø£Ø¯Ø®Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…">
                    <div class="validation-message" id="education-dept-error">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
                </div>
                
                <div class="form-group">
                    <label for="school-name">Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</label>
                    <input type="text" id="school-name" value="Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ" readonly>
                </div>
                
                <div class="form-group">
                    <label for="teacher-name">Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…</label>
                    <input type="text" id="teacher-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…">
                    <div class="validation-message" id="teacher-name-error">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
                </div>
                
                <div class="form-group">
                    <label for="specialization">Ø§Ù„ØªØ®ØµØµ</label>
                    <input type="text" id="specialization" placeholder="Ø§Ù„ØªØ®ØµØµ">
                </div>
                
                <div class="form-group">
                    <label for="semester">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
                    <select id="semester">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</option>
                        <option value="first">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø£ÙˆÙ„</option>
                        <option value="second">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                        <option value="third">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù„Ø«</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="grade">Ø§Ù„ØµÙ</label>
                    <select id="grade">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
                        <option value="first">Ø§Ù„Ø£ÙˆÙ„ Ù…ØªÙˆØ³Ø·</option>
                        <option value="second">Ø§Ù„Ø«Ø§Ù†ÙŠ Ù…ØªÙˆØ³Ø·</option>
                        <option value="third">Ø§Ù„Ø«Ø§Ù„Ø« Ù…ØªÙˆØ³Ø·</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="date">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                    <input type="date" id="date">
                </div>
                
                <div class="form-group">
                    <label for="day">Ø§Ù„ÙŠÙˆÙ…</label>
                    <input type="text" id="day" placeholder="Ø§Ù„ÙŠÙˆÙ…" readonly>
                </div>
                
                <div class="form-group">
                    <label for="period">Ø§Ù„Ø­ØµØ©</label>
                    <select id="period">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø­ØµØ©</option>
                        <option value="1">Ø§Ù„Ø­ØµØ© Ø§Ù„Ø£ÙˆÙ„Ù‰</option>
                        <option value="2">Ø§Ù„Ø­ØµØ© Ø§Ù„Ø«Ø§Ù†ÙŠØ©</option>
                        <option value="3">Ø§Ù„Ø­ØµØ© Ø§Ù„Ø«Ø§Ù„Ø«Ø©</option>
                        <option value="4">Ø§Ù„Ø­ØµØ© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©</option>
                        <option value="5">Ø§Ù„Ø­ØµØ© Ø§Ù„Ø®Ø§Ù…Ø³Ø©</option>
                        <option value="6">Ø§Ù„Ø­ØµØ© Ø§Ù„Ø³Ø§Ø¯Ø³Ø©</option>
                        <option value="7">Ø§Ù„Ø­ØµØ© Ø§Ù„Ø³Ø§Ø¨Ø¹Ø©</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="attendance">Ø§Ù„ØºÙŠØ§Ø¨</label>
                    <input type="number" id="attendance" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„ØºØ§Ø¦Ø¨ÙŠÙ†" min="0">
                </div>
                
                <div class="form-group">
                    <label for="presence">Ø§Ù„Ø­Ø¶ÙˆØ±</label>
                    <input type="number" id="presence" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ø­Ø§Ø¶Ø±ÙŠÙ†" min="0">
                </div>
                
                <div class="form-group">
                    <label for="venue">Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ†ÙÙŠØ°</label>
                    <input type="text" id="venue" placeholder="Ù…ÙƒØ§Ù† ØªÙ†ÙÙŠØ° Ø§Ù„Ù†Ø´Ø§Ø·">
                </div>
                
                <div class="form-group">
                    <label for="program-name">Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</label>
                    <input type="text" id="program-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬/Ø§Ù„Ù†Ø´Ø§Ø·">
                    <div class="validation-message" id="program-name-error">Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù…Ø·Ù„ÙˆØ¨</div>
                </div>
                
                <div class="form-group large-field">
                    <label for="program-objectives">Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</label>
                    <textarea id="program-objectives" placeholder="Ø§ÙƒØªØ¨ Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙˆØ§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©..."></textarea>
                </div>
                
                <div class="form-group large-field">
                    <label for="program-impact">Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ Ù„Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</label>
                    <textarea id="program-impact" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ ÙˆØ§Ù„ÙÙˆØ§Ø¦Ø¯ Ø§Ù„Ù…Ø­Ù‚Ù‚Ø© Ù…Ù† Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ..."></textarea>
                </div>
                
                <!-- Evidence Upload Section -->
                <div class="form-group large-field">
                    <label for="evidence-text">ÙˆØµÙ Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯</label>
                    <textarea id="evidence-text" placeholder="Ø§ÙƒØªØ¨ ÙˆØµÙ Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ ÙˆØ§Ù„Ø£Ø¯Ù„Ø© Ø¹Ù„Ù‰ Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬..."></textarea>
                </div>

                <div class="form-group large-field">
                    <label>Ø±ÙØ¹ Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ (Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ù…Ù„ÙØ§Øª)</label>
                    <div class="evidence-section" id="evidence-section">
                        <div class="upload-area" onclick="document.getElementById('evidence-files').click()">
                            <div class="upload-icon">ğŸ“</div>
                            <div class="upload-text">Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„ÙØ§Øª Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„ØªØµÙØ­</div>
                            <div class="upload-subtext">ÙŠÙ…ÙƒÙ† Ø±ÙØ¹ Ø§Ù„ØµÙˆØ± (JPG, PNG) ÙˆØ§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª (DOC)</div>
                            <button type="button" class="upload-btn">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„ÙØ§Øª</button>
                        </div>
                        <input type="file" id="evidence-files" class="file-input" multiple accept="image/*,.doc,.docx">
                        <div class="evidence-preview" id="evidence-preview"></div>
                    </div>
                </div>
            </form>
            
            <!-- Daily Report Form -->
            <form class="form-grid hidden" id="daily-report-form">
                <div class="form-group">
                    <label for="daily-education-dept">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</label>
                    <input type="text" id="daily-education-dept" placeholder="Ø£Ø¯Ø®Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…">
                </div>
                
                <div class="form-group">
                    <label for="daily-school-name">Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</label>
                    <input type="text" id="daily-school-name" value="Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ" readonly>
                </div>
                
                <div class="form-group">
                    <label for="daily-teacher-name">Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…</label>
                    <input type="text" id="daily-teacher-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…">
                </div>
                
                <div class="form-group">
                    <label for="daily-specialization">Ø§Ù„ØªØ®ØµØµ</label>
                    <input type="text" id="daily-specialization" placeholder="Ø§Ù„ØªØ®ØµØµ">
                </div>
                
                <div class="form-group">
                    <label for="daily-semester">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
                    <select id="daily-semester">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</option>
                        <option value="first">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø£ÙˆÙ„</option>
                        <option value="second">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                        <option value="third">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù„Ø«</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="daily-grade">Ø§Ù„ØµÙ</label>
                    <select id="daily-grade">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
                        <option value="first">Ø§Ù„Ø£ÙˆÙ„ Ù…ØªÙˆØ³Ø·</option>
                        <option value="second">Ø§Ù„Ø«Ø§Ù†ÙŠ Ù…ØªÙˆØ³Ø·</option>
                        <option value="third">Ø§Ù„Ø«Ø§Ù„Ø« Ù…ØªÙˆØ³Ø·</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="daily-date">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                    <input type="date" id="daily-date">
                </div>
                
                <div class="form-group">
                    <label for="daily-period">Ø§Ù„Ø­ØµØ©</label>
                    <select id="daily-period">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø­ØµØ©</option>
                        <option value="1">Ø§Ù„Ø­ØµØ© Ø§Ù„Ø£ÙˆÙ„Ù‰</option>
                        <option value="2">Ø§Ù„Ø­ØµØ© Ø§Ù„Ø«Ø§Ù†ÙŠØ©</option>
                        <option value="3">Ø§Ù„Ø­ØµØ© Ø§Ù„Ø«Ø§Ù„Ø«Ø©</option>
                        <option value="4">Ø§Ù„Ø­ØµØ© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©</option>
                        <option value="5">Ø§Ù„Ø­ØµØ© Ø§Ù„Ø®Ø§Ù…Ø³Ø©</option>
                        <option value="6">Ø§Ù„Ø­ØµØ© Ø§Ù„Ø³Ø§Ø¯Ø³Ø©</option>
                        <option value="7">Ø§Ù„Ø­ØµØ© Ø§Ù„Ø³Ø§Ø¨Ø¹Ø©</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="daily-unit">Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©</label>
                    <input type="text" id="daily-unit" placeholder="Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©">
                </div>
                
                <div class="form-group">
                    <label for="daily-lesson-title">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³</label>
                    <input type="text" id="daily-lesson-title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³">
                </div>
                
                <div class="form-group large-field">
                    <label for="daily-objectives">Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¯Ø±Ø³</label>
                    <textarea id="daily-objectives" placeholder="Ø§ÙƒØªØ¨ Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¯Ø±Ø³..."></textarea>
                </div>
                
                <div class="form-group large-field">
                    <label for="daily-achievement-percentage">Ù†Ø³Ø¨Ø© ØªØ­Ù‚Ù‚ Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¯Ø±Ø³</label>
                    <textarea id="daily-achievement-percentage" placeholder="Ø§ÙƒØªØ¨ Ù†Ø³Ø¨Ø© ØªØ­Ù‚Ù‚ Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¯Ø±Ø³..."></textarea>
                </div>
                
                <div class="form-group large-field">
                    <label for="daily-student-interaction">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø­ÙˆÙ„ ØªÙØ§Ø¹Ù„ Ø§Ù„Ø·Ù„Ø¨</label>
                    <textarea id="daily-student-interaction" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø­ÙˆÙ„ ØªÙØ§Ø¹Ù„ Ø§Ù„Ø·Ù„Ø¨..."></textarea>
                </div>
                
                <div class="form-group large-field">
                    <label for="daily-challenges">Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„ØµÙÙŠØ©</label>
                    <textarea id="daily-challenges" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„ØµÙÙŠØ©..."></textarea>
                </div>

                <div class="form-group large-field">
                    <label>Ø±ÙØ¹ Ø´ÙˆØ§Ù‡Ø¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ</label>
                    <div class="evidence-section" id="daily-evidence-section">
                        <div class="upload-area" onclick="document.getElementById('daily-evidence-files').click()">
                            <div class="upload-icon">ğŸ“</div>
                            <div class="upload-text">Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„ÙØ§Øª Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„ØªØµÙØ­</div>
                            <div class="upload-subtext">ØµÙˆØ± Ø§Ù„Ø£Ù†Ø´Ø·Ø©ØŒ Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„ØŒ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</div>
                            <button type="button" class="upload-btn">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„ÙØ§Øª</button>
                        </div>
                        <input type="file" id="daily-evidence-files" class="file-input" multiple accept="image/*,.doc,.docx">
                        <div class="evidence-preview" id="daily-evidence-preview"></div>
                    </div>
                </div>
            </form>
            
            <!-- Weekly Report Form -->
            <form class="form-grid hidden" id="weekly-report-form">
                <div class="form-group">
                    <label for="weekly-education-dept">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</label>
                    <input type="text" id="weekly-education-dept" placeholder="Ø£Ø¯Ø®Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…">
                </div>
                
                <div class="form-group">
                    <label for="weekly-school-name">Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</label>
                    <input type="text" id="weekly-school-name" value="Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ" readonly>
                </div>
                
                <div class="form-group">
                    <label for="weekly-teacher-name">Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…</label>
                    <input type="text" id="weekly-teacher-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…">
                </div>
                
                <div class="form-group">
                    <label for="weekly-specialization">Ø§Ù„ØªØ®ØµØµ</label>
                    <input type="text" id="weekly-specialization" placeholder="Ø§Ù„ØªØ®ØµØµ">
                </div>
                
                <div class="form-group">
                    <label for="weekly-semester">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
                    <select id="weekly-semester">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</option>
                        <option value="first">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø£ÙˆÙ„</option>
                        <option value="second">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                        <option value="third">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù„Ø«</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="weekly-grade">Ø§Ù„ØµÙ</label>
                    <select id="weekly-grade">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
                        <option value="first">Ø§Ù„Ø£ÙˆÙ„ Ù…ØªÙˆØ³Ø·</option>
                        <option value="second">Ø§Ù„Ø«Ø§Ù†ÙŠ Ù…ØªÙˆØ³Ø·</option>
                        <option value="third">Ø§Ù„Ø«Ø§Ù„Ø« Ù…ØªÙˆØ³Ø·</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="weekly-date">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                    <input type="date" id="weekly-date">
                </div>
                
                <div class="form-group">
                    <label for="weekly-week">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</label>
                    <input type="text" id="weekly-week" placeholder="Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹">
                </div>
                
                <div class="form-group">
                    <label for="weekly-lessons-taught">Ø£Ù‡Ù… Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ù…Ù†ÙØ°Ø©</label>
                    <input type="text" id="weekly-lessons-taught" placeholder="Ø£Ù‡Ù… Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ù…Ù†ÙØ°Ø©">
                </div>
                
                <div class="form-group large-field">
                    <label for="weekly-strength-points">Ø£Ø¨Ø±Ø² Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© Ù„Ø¯Ù‰ Ø§Ù„Ø·Ù„Ø¨</label>
                    <textarea id="weekly-strength-points" placeholder="Ø§ÙƒØªØ¨ Ø£Ø¨Ø±Ø² Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© Ù„Ø¯Ù‰ Ø§Ù„Ø·Ù„Ø¨..."></textarea>
                </div>
                
                <div class="form-group large-field">
                    <label for="weekly-weakness-points">Ø£Ø¨Ø±Ø² Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù Ù„Ø¯Ù‰ Ø§Ù„Ø·Ù„Ø¨</label>
                    <textarea id="weekly-weakness-points" placeholder="Ø§ÙƒØªØ¨ Ø£Ø¨Ø±Ø² Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù Ù„Ø¯Ù‰ Ø§Ù„Ø·Ù„Ø¨..."></textarea>
                </div>
                
                <div class="form-group large-field">
                    <label for="weekly-educational-challenges">Ø£Ø¨Ø±Ø² Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</label>
                    <textarea id="weekly-educational-challenges" placeholder="Ø§ÙƒØªØ¨ Ø£Ø¨Ø±Ø² Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©..."></textarea>
                </div>

                <div class="form-group large-field">
                    <label>Ø±ÙØ¹ Ø´ÙˆØ§Ù‡Ø¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</label>
                    <div class="evidence-section" id="weekly-evidence-section">
                        <div class="upload-area" onclick="document.getElementById('weekly-evidence-files').click()">
                            <div class="upload-icon">ğŸ“</div>
                            <div class="upload-text">Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„ÙØ§Øª Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„ØªØµÙØ­</div>
                            <div class="upload-subtext">Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…ØŒ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ØŒ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</div>
                            <button type="button" class="upload-btn">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„ÙØ§Øª</button>
                        </div>
                        <input type="file" id="weekly-evidence-files" class="file-input" multiple accept="image/*,.doc,.docx">
                        <div class="evidence-preview" id="weekly-evidence-preview"></div>
                    </div>
                </div>
            </form>
            
            <!-- Monthly Report Form -->
            <form class="form-grid hidden" id="monthly-report-form">
                <div class="form-group">
                    <label for="monthly-education-dept">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</label>
                    <input type="text" id="monthly-education-dept" placeholder="Ø£Ø¯Ø®Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…">
                </div>
                
                <div class="form-group">
                    <label for="monthly-school-name">Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</label>
                    <input type="text" id="monthly-school-name" value="Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ" readonly>
                </div>
                
                <div class="form-group">
                    <label for="monthly-teacher-name">Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…</label>
                    <input type="text" id="monthly-teacher-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…">
                </div>
                
                <div class="form-group">
                    <label for="monthly-specialization">Ø§Ù„ØªØ®ØµØµ</label>
                    <input type="text" id="monthly-specialization" placeholder="Ø§Ù„ØªØ®ØµØµ">
                </div>
                
                <div class="form-group">
                    <label for="monthly-semester">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</label>
                    <select id="monthly-semester">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ</option>
                        <option value="first">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø£ÙˆÙ„</option>
                        <option value="second">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                        <option value="third">Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ø§Ù„Ø«Ø§Ù„Ø«</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="monthly-grade">Ø§Ù„ØµÙ</label>
                    <select id="monthly-grade">
                        <option value="">Ø§Ø®ØªØ± Ø§Ù„ØµÙ</option>
                        <option value="first">Ø§Ù„Ø£ÙˆÙ„ Ù…ØªÙˆØ³Ø·</option>
                        <option value="second">Ø§Ù„Ø«Ø§Ù†ÙŠ Ù…ØªÙˆØ³Ø·</option>
                        <option value="third">Ø§Ù„Ø«Ø§Ù„Ø« Ù…ØªÙˆØ³Ø·</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="monthly-date">Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                    <input type="date" id="monthly-date">
                </div>
                
                <div class="form-group">
                    <label for="monthly-month">Ø§Ù„Ø´Ù‡Ø±</label>
                    <input type="text" id="monthly-month" placeholder="Ø§Ù„Ø´Ù‡Ø±">
                </div>
                
                <div class="form-group">
                    <label for="monthly-completion-rate">Ù†Ø³Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø®Ø·Ø©</label>
                    <input type="text" id="monthly-completion-rate" placeholder="Ù†Ø³Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø®Ø·Ø©">
                </div>
                
                <div class="form-group large-field">
                    <label for="monthly-improved-issues">Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§ Ø§Ù„Ù…Ø³ØªØ­Ø¯Ø«Ø© Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ù…ØªØ§Ø¨Ø¹Ø©</label>
                    <textarea id="monthly-improved-issues" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§ Ø§Ù„Ù…Ø³ØªØ­Ø¯Ø«Ø© Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ù…ØªØ§Ø¨Ø¹Ø©..."></textarea>
                </div>
                
                <div class="form-group large-field">
                    <label for="monthly-treatment-plans">Ø®Ø·Ø· Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©</label>
                    <textarea id="monthly-treatment-plans" placeholder="Ø§ÙƒØªØ¨ Ø®Ø·Ø· Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©..."></textarea>
                </div>
                
                <div class="form-group large-field">
                    <label for="monthly-outstanding-students">Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…ØªÙ…ÙŠØ²ÙˆÙ†</label>
                    <textarea id="monthly-outstanding-students" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…ØªÙ…ÙŠØ²ÙˆÙ†..."></textarea>
                </div>
                
                <div class="form-group large-field">
                    <label for="monthly-final-plan">Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¥Ø«Ø±Ø§Ø¦ÙŠØ© Ù„Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…ØªÙ…ÙŠØ²ÙŠÙ†</label>
                    <textarea id="monthly-final-plan" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¥Ø«Ø±Ø§Ø¦ÙŠØ© Ù„Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…ØªÙ…ÙŠØ²ÙŠÙ†..."></textarea>
                </div>

                <div class="form-group large-field">
                    <label>Ø±ÙØ¹ Ø´ÙˆØ§Ù‡Ø¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ</label>
                    <div class="evidence-section" id="monthly-evidence-section">
                        <div class="upload-area" onclick="document.getElementById('monthly-evidence-files').click()">
                            <div class="upload-icon">ğŸ“</div>
                            <div class="upload-text">Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„ÙØ§Øª Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø± Ù„Ù„ØªØµÙØ­</div>
                            <div class="upload-subtext">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø´Ø§Ù…Ù„Ø©ØŒ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§ØªØŒ Ø§Ù„Ø®Ø·Ø· Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©</div>
                            <button type="button" class="upload-btn">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„ÙØ§Øª</button>
                        </div>
                        <input type="file" id="monthly-evidence-files" class="file-input" multiple accept="image/*,.doc,.docx">
                        <div class="evidence-preview" id="monthly-evidence-preview"></div>
                    </div>
                </div>
            </form>
            
            <div class="action-buttons">
                <button class="btn" onclick="generatePDF()">
                    ğŸ“„ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù PDF
                </button>
                <button class="btn secondary" onclick="clearForm()">
                    ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                </button>
                <button class="btn secondary" onclick="exportToExcel()">
                    ğŸ“Š ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ Excel
                </button>
                <button class="btn secondary" onclick="saveFormData()">
                    ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
                <button class="btn secondary" onclick="validateForm()">
                    âœ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
            </div>
        </div>
        
        <!-- Report Selection Modal -->
        <div id="reportModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeReportModal()">&times;</span>
                <h2>Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</h2>
                <div class="report-options">
                    <button class="report-option" onclick="selectReportType('daily')">
                        ğŸ“Š Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ
                    </button>
                    <button class="report-option" onclick="selectReportType('weekly')">
                        ğŸ“ˆ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ
                    </button>
                    <button class="report-option" onclick="selectReportType('monthly')">
                        ğŸ“‹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ
                    </button>
                </div>
            </div>
        </div>

        <!-- Image Modal -->
        <div id="imageModal" class="image-modal" onclick="closeImageModal()">
            <div class="image-modal-content">
                <span class="image-modal-close" onclick="closeImageModal()">&times;</span>
                <img id="modalImage" src="" alt="">
                <div class="image-modal-info">
                    <div class="image-name" id="modalImageName"></div>
                    <div class="image-details" id="modalImageDetails"></div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="footer fade-in">
            <p>Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ - Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ</p>
            <p>Ø±Ø§Ø¦Ø¯ Ø§Ù„Ù†Ø´Ø§Ø·: Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ø­Ø±Ø¨ÙŠ</p>
            <div class="copyright">
                <p>âš ï¸ Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù†Ø³Ø® Ù…Ø­ÙÙˆØ¸Ø©</p>
                <p>Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªÙ†ÙÙŠØ°: <span class="developer">Nawaf AlSubhi</span></p>
            </div>
        </div>
    </div>
    
    <script>
        let currentReportType = 'activity';
        let stats = {
            reportsGenerated: 0,
            formsCompleted: 0,
            evidenceUploaded: 0
        };

        let uploadedFiles = {
            activity: [],
            daily: [],
            weekly: [],
            monthly: []
        };
        
        // Field mappings for all report types
        const fieldMappings = {
            'activity': {
                order: [
                    'education-dept', 'school-name', 'teacher-name', 'specialization', 'semester', 'grade',
                    'date', 'day', 'period', 'attendance', 'presence', 'venue', 'program-name',
                    'program-objectives', 'program-impact', 'evidence-text'
                ],
                labels: {
                    'education-dept': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…',
                    'school-name': 'Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©',
                    'semester': 'Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ',
                    'specialization': 'Ø§Ù„ØªØ®ØµØµ', 
                    'teacher-name': 'Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…',
                    'grade': 'Ø§Ù„ØµÙ',
                    'date': 'Ø§Ù„ØªØ§Ø±ÙŠØ®',
                    'day': 'Ø§Ù„ÙŠÙˆÙ…',
                    'period': 'Ø§Ù„Ø­ØµØ©',
                    'attendance': 'Ø§Ù„ØºÙŠØ§Ø¨',
                    'presence': 'Ø§Ù„Ø­Ø¶ÙˆØ±',
                    'venue': 'Ù…ÙƒØ§Ù† Ø§Ù„ØªÙ†ÙÙŠØ°',
                    'program-name': 'Ø§Ø³Ù… Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬',
                    'program-objectives': 'Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬',
                    'program-impact': 'Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ Ù„Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬',
                    'evidence-text': 'ÙˆØµÙ Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯'
                }
            },
            'daily': {
                order: [
                    'daily-education-dept', 'daily-school-name', 'daily-teacher-name', 'daily-specialization',
                    'daily-semester', 'daily-grade', 'daily-date', 'daily-period', 'daily-unit', 'daily-lesson-title',
                    'daily-objectives', 'daily-achievement-percentage', 'daily-student-interaction', 'daily-challenges'
                ],
                labels: {
                    'daily-education-dept': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…',
                    'daily-school-name': 'Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©',
                    'daily-teacher-name': 'Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…',
                    'daily-specialization': 'Ø§Ù„ØªØ®ØµØµ',
                    'daily-semester': 'Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ',
                    'daily-grade': 'Ø§Ù„ØµÙ',
                    'daily-date': 'Ø§Ù„ØªØ§Ø±ÙŠØ®',
                    'daily-period': 'Ø§Ù„Ø­ØµØ©',
                    'daily-unit': 'Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©',
                    'daily-lesson-title': 'Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³',
                    'daily-objectives': 'Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¯Ø±Ø³',
                    'daily-achievement-percentage': 'Ù†Ø³Ø¨Ø© ØªØ­Ù‚Ù‚ Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø¯Ø±Ø³',
                    'daily-student-interaction': 'Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø­ÙˆÙ„ ØªÙØ§Ø¹Ù„ Ø§Ù„Ø·Ù„Ø¨',
                    'daily-challenges': 'Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„ØµÙÙŠØ©'
                }
            },
            'weekly': {
                order: [
                    'weekly-education-dept', 'weekly-school-name', 'weekly-teacher-name', 'weekly-specialization',
                    'weekly-semester', 'weekly-grade', 'weekly-date', 'weekly-week', 'weekly-lessons-taught',
                    'weekly-strength-points', 'weekly-weakness-points', 'weekly-educational-challenges'
                ],
                labels: {
                    'weekly-education-dept': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…',
                    'weekly-school-name': 'Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©',
                    'weekly-teacher-name': 'Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…',
                    'weekly-specialization': 'Ø§Ù„ØªØ®ØµØµ',
                    'weekly-semester': 'Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ',
                    'weekly-grade': 'Ø§Ù„ØµÙ',
                    'weekly-date': 'Ø§Ù„ØªØ§Ø±ÙŠØ®',
                    'weekly-week': 'Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹',
                    'weekly-lessons-taught': 'Ø£Ù‡Ù… Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ù…Ù†ÙØ°Ø©',
                    'weekly-strength-points': 'Ø£Ø¨Ø±Ø² Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ© Ù„Ø¯Ù‰ Ø§Ù„Ø·Ù„Ø¨',
                    'weekly-weakness-points': 'Ø£Ø¨Ø±Ø² Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù Ù„Ø¯Ù‰ Ø§Ù„Ø·Ù„Ø¨',
                    'weekly-educational-challenges': 'Ø£Ø¨Ø±Ø² Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©'
                }
            },
            'monthly': {
                order: [
                    'monthly-education-dept', 'monthly-school-name', 'monthly-teacher-name', 'monthly-specialization',
                    'monthly-semester', 'monthly-grade', 'monthly-date', 'monthly-month', 'monthly-completion-rate',
                    'monthly-improved-issues', 'monthly-treatment-plans', 'monthly-outstanding-students', 'monthly-final-plan'
                ],
                labels: {
                    'monthly-education-dept': 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…',
                    'monthly-school-name': 'Ø§Ø³Ù… Ø§Ù„Ù…Ø¯Ø±Ø³Ø©',
                    'monthly-teacher-name': 'Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…',
                    'monthly-specialization': 'Ø§Ù„ØªØ®ØµØµ',
                    'monthly-semester': 'Ø§Ù„ÙØµÙ„ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ',
                    'monthly-grade': 'Ø§Ù„ØµÙ',
                    'monthly-date': 'Ø§Ù„ØªØ§Ø±ÙŠØ®',
                    'monthly-month': 'Ø§Ù„Ø´Ù‡Ø±',
                    'monthly-completion-rate': 'Ù†Ø³Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø®Ø·Ø©',
                    'monthly-improved-issues': 'Ø§Ù„Ù‚Ø¶Ø§ÙŠØ§ Ø§Ù„Ù…Ø³ØªØ­Ø¯Ø«Ø© Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ù…ØªØ§Ø¨Ø¹Ø©',
                    'monthly-treatment-plans': 'Ø®Ø·Ø· Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©',
                    'monthly-outstanding-students': 'Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…ØªÙ…ÙŠØ²ÙˆÙ†',
                    'monthly-final-plan': 'Ø§Ù„Ø®Ø·Ø© Ø§Ù„Ø¥Ø«Ø±Ø§Ø¦ÙŠØ© Ù„Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…ØªÙ…ÙŠØ²ÙŠÙ†'
                }
            }
        };
        
        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            initializeDateFields(today);
            loadSavedData();
            updateStats();
            setupFileUpload();
            
            setTimeout(() => {
                document.querySelectorAll('.loading').forEach(el => {
                    el.classList.remove('loading');
                });
            }, 2000);

            addFormProgressTracking();
        });

        // File Upload Setup
        function setupFileUpload() {
            const evidenceSections = ['evidence-section', 'daily-evidence-section', 'weekly-evidence-section', 'monthly-evidence-section'];
            const fileInputs = ['evidence-files', 'daily-evidence-files', 'weekly-evidence-files', 'monthly-evidence-files'];
            
            evidenceSections.forEach((sectionId, index) => {
                const section = document.getElementById(sectionId);
                const fileInput = document.getElementById(fileInputs[index]);
                
                if (section && fileInput) {
                    // Drag and drop functionality
                    section.addEventListener('dragover', function(e) {
                        e.preventDefault();
                        this.classList.add('dragover');
                    });
                    
                    section.addEventListener('dragleave', function(e) {
                        e.preventDefault();
                        this.classList.remove('dragover');
                    });
                    
                    section.addEventListener('drop', function(e) {
                        e.preventDefault();
                        this.classList.remove('dragover');
                        const files = e.dataTransfer.files;
                        handleFileUpload(files, getReportTypeFromSectionId(sectionId));
                    });
                    
                    // File input change event
                    fileInput.addEventListener('change', function(e) {
                        const files = e.target.files;
                        handleFileUpload(files, getReportTypeFromSectionId(sectionId));
                    });
                }
            });
        }

        function getReportTypeFromSectionId(sectionId) {
            if (sectionId.includes('daily')) return 'daily';
            if (sectionId.includes('weekly')) return 'weekly';
            if (sectionId.includes('monthly')) return 'monthly';
            return 'activity';
        }

        function handleFileUpload(files, reportType) {
            const maxFileSize = 10 * 1024 * 1024; // 10MB
            const allowedTypes = ['image/jpeg', 'image/png', 'image/gif', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
            
            Array.from(files).forEach(file => {
                if (file.size > maxFileSize) {
                    showNotification('Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹. Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 10 Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª', 'error');
                    return;
                }
                
                if (!allowedTypes.includes(file.type)) {
                    showNotification('Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…. ÙŠØ±Ø¬Ù‰ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ± Ø£Ùˆ Ù…Ø³ØªÙ†Ø¯Ø§Øª Word ÙÙ‚Ø·', 'error');
                    return;
                }
                
                const fileData = {
                    name: file.name,
                    size: file.size,
                    type: file.type,
                    lastModified: file.lastModified,
                    data: null
                };
                
                // Read file as base64 for storage
                const reader = new FileReader();
                reader.onload = function(e) {
                    fileData.data = e.target.result;
                    uploadedFiles[reportType].push(fileData);
                    updateEvidencePreview(reportType);
                    stats.evidenceUploaded++;
                    updateStats();
                    showNotification(`ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù: ${file.name}`, 'success');
                };
                reader.readAsDataURL(file);
            });
        }

        function updateEvidencePreview(reportType) {
            const previewId = reportType === 'activity' ? 'evidence-preview' : `${reportType}-evidence-preview`;
            const preview = document.getElementById(previewId);
            
            if (!preview) return;
            
            preview.innerHTML = '';
            
            uploadedFiles[reportType].forEach((file, index) => {
                const item = document.createElement('div');
                item.className = 'evidence-item';
                
                let content = '';
                if (file.type.startsWith('image/')) {
                    content = `<img src="${file.data}" alt="${file.name}">`;
                } else {
                    content = `<div style="height: 80px; display: flex; align-items: center; justify-content: center; background: #f8f9fa; color: #2c6470; font-size: 2em;">ğŸ“„</div>`;
                }
                
                item.innerHTML = `
                    ${content}
                    <div class="file-info">${file.name}</div>
                    <button class="remove-btn" onclick="removeFile('${reportType}', ${index})">&times;</button>
                `;
                
                preview.appendChild(item);
            });
        }

        function removeFile(reportType, index) {
            uploadedFiles[reportType].splice(index, 1);
            updateEvidencePreview(reportType);
            stats.evidenceUploaded = Math.max(0, stats.evidenceUploaded - 1);
            updateStats();
            showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù', 'info');
        }
        
        function initializeDateFields(date) {
            const dateInputs = ['date', 'daily-date', 'weekly-date', 'monthly-date'];
            const days = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø§Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Ø§Ù„Ø³Ø¨Øª'];
            
            dateInputs.forEach(inputId => {
                const dateInput = document.getElementById(inputId);
                if (dateInput) {
                    dateInput.value = date.toISOString().split('T')[0];
                    
                    dateInput.addEventListener('change', function() {
                        const selectedDate = new Date(this.value);
                        const dayInputId = inputId.replace('date', 'day');
                        const dayInput = document.getElementById(dayInputId);
                        if (dayInput) {
                            dayInput.value = days[selectedDate.getDay()];
                        }
                    });
                }
            });
            
            const dayInput = document.getElementById('day');
            if (dayInput) {
                dayInput.value = days[date.getDay()];
            }
        }

        // Form Progress Tracking
        function addFormProgressTracking() {
            const forms = ['activity-form', 'daily-report-form', 'weekly-report-form', 'monthly-report-form'];
            
            forms.forEach(formId => {
                const form = document.getElementById(formId);
                if (form) {
                    const inputs = form.querySelectorAll('input:not([readonly]), select, textarea');
                    inputs.forEach(input => {
                        input.addEventListener('input', updateFormProgress);
                        input.addEventListener('change', updateFormProgress);
                    });
                }
            });
        }

        function updateFormProgress() {
            const currentForm = getCurrentActiveForm();
            if (!currentForm) return;

            const inputs = currentForm.querySelectorAll('input:not([readonly]), select, textarea');
            const filledInputs = Array.from(inputs).filter(input => input.value.trim() !== '');
            const progress = (filledInputs.length / inputs.length) * 100;

            const progressFill = document.getElementById('form-progress');
            if (progressFill) {
                progressFill.style.width = progress + '%';
            }

            if (progress === 100) {
                stats.formsCompleted++;
                updateStats();
                showNotification('ØªÙ… Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            }
        }

        function getCurrentActiveForm() {
            const forms = ['activity-form', 'daily-report-form', 'weekly-report-form', 'monthly-report-form'];
            return forms.map(id => document.getElementById(id)).find(form => !form.classList.contains('hidden'));
        }

        // Enhanced Statistics Functions
        function updateStats() {
            document.getElementById('reports-generated').textContent = stats.reportsGenerated;
            document.getElementById('forms-completed').textContent = stats.formsCompleted;
            document.getElementById('evidence-uploaded').textContent = stats.evidenceUploaded;
        }

        // Data Management Functions
        function saveFormData() {
            const currentMapping = fieldMappings[currentReportType];
            const formData = getCurrentFormData(currentMapping.order);
            
            const savedData = {
                reportType: currentReportType,
                data: formData,
                files: uploadedFiles[currentReportType],
                timestamp: new Date().toISOString(),
                formTitle: document.getElementById('form-title').textContent
            };

            const allSavedData = JSON.parse(localStorage.getItem('studentActivityData') || '[]');
            allSavedData.push(savedData);
            localStorage.setItem('studentActivityData', JSON.stringify(allSavedData));
            
            showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
        }

        function loadSavedData() {
            const savedData = localStorage.getItem('studentActivityData');
            if (savedData) {
                const data = JSON.parse(savedData);
                stats.formsCompleted = data.length;
                
                // Count total uploaded files
                stats.evidenceUploaded = data.reduce((total, item) => {
                    return total + (item.files ? item.files.length : 0);
                }, 0);
                
                updateStats();
            }
        }

        function backupData() {
            const allData = {
                forms: JSON.parse(localStorage.getItem('studentActivityData') || '[]'),
                files: uploadedFiles,
                stats: stats,
                timestamp: new Date().toISOString(),
                version: '3.0'
            };

            const dataStr = JSON.stringify(allData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `student_activity_backup_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showNotification('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
        }

        function restoreData(input) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (data.forms) {
                        localStorage.setItem('studentActivityData', JSON.stringify(data.forms));
                    }
                    if (data.files) {
                        uploadedFiles = { ...uploadedFiles, ...data.files };
                        updateAllEvidencePreviews();
                    }
                    if (data.stats) {
                        stats = { ...stats, ...data.stats };
                        updateStats();
                    }
                    
                    showNotification('ØªÙ… Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                    
                } catch (error) {
                    showNotification('Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©', 'error');
                }
            };
            reader.readAsText(file);
        }

        function updateAllEvidencePreviews() {
            Object.keys(uploadedFiles).forEach(reportType => {
                updateEvidencePreview(reportType);
            });
        }

        function exportAllData() {
            const allData = JSON.parse(localStorage.getItem('studentActivityData') || '[]');
            
            if (allData.length === 0) {
                showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±', 'warning');
                return;
            }

            let csvContent = "data:text/csv;charset=utf-8,\uFEFF";
            csvContent += "Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±,Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬,Ø§Ù„ØªØ§Ø±ÙŠØ®,Ø¹Ø¯Ø¯ Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯,Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª\n";

            allData.forEach(item => {
                const dataStr = Object.entries(item.data)
                    .map(([key, value]) => `${key}: ${value}`)
                    .join('; ');
                
                const filesCount = item.files ? item.files.length : 0;
                
                csvContent += `"${item.reportType}","${item.formTitle}","${new Date(item.timestamp).toLocaleDateString('ar-SA')}","${filesCount}","${dataStr}"\n`;
            });

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `all_student_activity_data_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('ØªÙ… ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
        }

        // Form Validation
        function validateForm() {
            const currentForm = getCurrentActiveForm();
            if (!currentForm) return false;

            const requiredFields = [
                'education-dept', 'teacher-name', 'program-name',
                'daily-teacher-name', 'weekly-teacher-name', 'monthly-teacher-name'
            ];

            let isValid = true;
            let errors = [];

            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field && field.offsetParent !== null) {
                    const errorElement = document.getElementById(fieldId + '-error');
                    
                    if (!field.value.trim()) {
                        field.classList.add('form-validation-error');
                        if (errorElement) {
                            errorElement.style.display = 'block';
                        }
                        isValid = false;
                        errors.push(fieldMappings[currentReportType]?.labels[fieldId] || fieldId);
                    } else {
                        field.classList.remove('form-validation-error');
                        if (errorElement) {
                            errorElement.style.display = 'none';
                        }
                    }
                }
            });

            if (isValid) {
                showNotification('ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù…ÙƒØªÙ…Ù„Ø©.', 'success');
            } else {
                showNotification(`ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„ØªØ§Ù„ÙŠØ©: ${errors.join(', ')}`, 'error');
            }

            return isValid;
        }
        
        function openFinalReport() {
            const modal = document.getElementById('reportModal');
            modal.style.display = 'block';
        }
        
        function closeReportModal() {
            const modal = document.getElementById('reportModal');
            modal.style.display = 'none';
        }
        
        function selectReportType(reportType) {
            currentReportType = reportType;
            closeReportModal();
            
            // Hide all forms and tabs
            document.getElementById('activity-form').classList.add('hidden');
            document.getElementById('daily-report-form').classList.add('hidden');
            document.getElementById('weekly-report-form').classList.add('hidden');
            document.getElementById('monthly-report-form').classList.add('hidden');
            document.getElementById('report-tabs').classList.add('hidden');
            
            // Show appropriate form and update title
            const formTitle = document.getElementById('form-title');
            
            if (reportType === 'daily') {
                document.getElementById('daily-report-form').classList.remove('hidden');
                document.getElementById('report-tabs').classList.remove('hidden');
                formTitle.textContent = 'Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ';
            } else if (reportType === 'weekly') {
                document.getElementById('weekly-report-form').classList.remove('hidden');
                document.getElementById('report-tabs').classList.remove('hidden');
                formTitle.textContent = 'Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ';
            } else if (reportType === 'monthly') {
                document.getElementById('monthly-report-form').classList.remove('hidden');
                document.getElementById('report-tabs').classList.remove('hidden');
                formTitle.textContent = 'Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ';
            }
            
            // Update tab active state
            updateTabActiveState(reportType);
            
            // Scroll to form
            document.querySelector('.form-section').scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
            
            const reportNames = {
                'daily': 'Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ',
                'weekly': 'Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ',
                'monthly': 'Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ'
            };
            
            showNotification(`ØªÙ… ØªØ­Ø¯ÙŠØ¯ ${reportNames[reportType]}`, 'success');
        }
        
        function switchTab(tabType) {
            currentReportType = tabType;
            
            // Hide all forms
            document.getElementById('daily-report-form').classList.add('hidden');
            document.getElementById('weekly-report-form').classList.add('hidden');
            document.getElementById('monthly-report-form').classList.add('hidden');
            
            // Show selected form
            document.getElementById(`${tabType}-report-form`).classList.remove('hidden');
            
            // Update form title
            const formTitle = document.getElementById('form-title');
            const titles = {
                'daily': 'Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ…ÙŠ',
                'weekly': 'Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ',
                'monthly': 'Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ'
            };
            formTitle.textContent = titles[tabType];
            
            // Update tab active state
            updateTabActiveState(tabType);
            
            // Reset progress bar
            updateFormProgress();
        }
        
        function updateTabActiveState(activeTab) {
            // Remove active class from all tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active class to selected tab
            const tabMapping = {
                'daily': 0,
                'weekly': 1,
                'monthly': 2
            };
            
            const tabButtons = document.querySelectorAll('.tab-btn');
            if (tabButtons[tabMapping[activeTab]]) {
                tabButtons[tabMapping[activeTab]].classList.add('active');
            }
        }
        
        function openActivity(activityName) {
            currentReportType = 'activity';
            
            // Hide all report forms and tabs
            document.getElementById('daily-report-form').classList.add('hidden');
            document.getElementById('weekly-report-form').classList.add('hidden');
            document.getElementById('monthly-report-form').classList.add('hidden');
            document.getElementById('report-tabs').classList.add('hidden');
            
            // Show activity form
            document.getElementById('activity-form').classList.remove('hidden');
            
            const formTitle = document.getElementById('form-title');
            formTitle.textContent = activityName;
            
            formTitle.style.animation = 'none';
            setTimeout(() => {
                formTitle.style.animation = 'fadeIn 0.5s ease-in';
            }, 10);
            
            document.querySelector('.form-section').scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
            
            // Reset progress bar
            updateFormProgress();
            
            showNotification(`ØªÙ… ØªØ­Ø¯ÙŠØ¯ ${activityName}`, 'success');
        }
        
        function clearForm() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) {
                let targetForm;
                
                if (currentReportType === 'daily') {
                    targetForm = document.getElementById('daily-report-form');
                } else if (currentReportType === 'weekly') {
                    targetForm = document.getElementById('weekly-report-form');
                } else if (currentReportType === 'monthly') {
                    targetForm = document.getElementById('monthly-report-form');
                } else {
                    targetForm = document.getElementById('activity-form');
                }
                
                targetForm.querySelectorAll('input:not([readonly]), select, textarea').forEach(input => {
                    input.value = '';
                    input.classList.remove('form-validation-error');
                });
                
                // Hide validation messages
                targetForm.querySelectorAll('.validation-message').forEach(msg => {
                    msg.style.display = 'none';
                });
                
                // Clear uploaded files
                uploadedFiles[currentReportType] = [];
                updateEvidencePreview(currentReportType);
                
                // Reset progress bar
                updateFormProgress();
                
                showNotification('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            }
        }

        // Helper functions for data collection
        function getCurrentFormData(fieldOrder) {
            const formData = {};
            fieldOrder.forEach(fieldId => {
                const element = document.getElementById(fieldId);
                if (element) {
                    formData[fieldId] = element.value || '';
                }
            });
            return formData;
        }

        // Enhanced PDF generation with evidence support
        function generatePDF() {
            if (!validateForm()) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù‚Ø¨Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±', 'warning');
                return;
            }

            showNotification('Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF Ù…Ø¹ Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯...', 'info');
            
            try {
                const htmlContent = generateHTMLForPDF();
                
                // Open print window with Arabic content
                const printWindow = window.open('', '_blank');
                printWindow.document.write(htmlContent);
                printWindow.document.close();
                
                // Auto print
                setTimeout(() => {
                    printWindow.focus();
                    printWindow.print();
                }, 1000);
                
                // Update statistics
                stats.reportsGenerated++;
                updateStats();
                
                showNotification('ØªÙ… ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©. ÙŠÙ…ÙƒÙ†Ùƒ Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù ÙƒÙ€ PDF Ù…Ù† Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©.', 'success');
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ PDF:', error);
                showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.', 'error');
            }
        }

        function generateHTMLForPDF() {
            const currentMapping = fieldMappings[currentReportType];
            const formData = getCurrentFormData(currentMapping.order);
            const reportTitle = document.getElementById('form-title').textContent;
            const currentFiles = uploadedFiles[currentReportType] || [];
            
            return `
            <!DOCTYPE html>
            <html dir="rtl" lang="ar">
            <head>
                <meta charset="UTF-8">
                <title>${reportTitle}</title>
                <style>
                    @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap');
                    
                    * {
                        margin: 0;
                        padding: 0;
                        box-sizing: border-box;
                    }
                    
                    body {
                        font-family: 'Tajawal', Arial, sans-serif;
                        line-height: 1.6;
                        color: #2c3e50;
                        background: white;
                        padding: 20px;
                    }
                    
                    .header {
                        text-align: center;
                        border: 3px solid #2c6470;
                        padding: 30px;
                        margin-bottom: 40px;
                        background: linear-gradient(135deg, #f8fbfc, #ffffff);
                        border-radius: 15px;
                    }
                    
                    .header h1 {
                        color: #2c6470;
                        font-size: 28px;
                        font-weight: 700;
                        margin-bottom: 10px;
                    }
                    
                    .header h2 {
                        color: #4a90a4;
                        font-size: 22px;
                        font-weight: 600;
                        margin-bottom: 8px;
                    }
                    
                    .header h3 {
                        color: #5ba3b8;
                        font-size: 18px;
                        font-weight: 500;
                        margin-bottom: 6px;
                    }
                    
                    .header h4 {
                        color: #6bb6c9;
                        font-size: 16px;
                        font-weight: 500;
                    }
                    
                    .report-title {
                        background: linear-gradient(135deg, #e8f4f8, #f0f8ff);
                        padding: 20px;
                        text-align: center;
                        border-radius: 10px;
                        margin-bottom: 30px;
                        border-right: 5px solid #4a90a4;
                    }
                    
                    .report-title h2 {
                        color: #2c6470;
                        font-size: 24px;
                        font-weight: 600;
                    }
                    
                    .content-section {
                        margin-bottom: 30px;
                        page-break-inside: avoid;
                    }
                    
                    .section-title {
                        background: #2c6470;
                        color: white;
                        padding: 12px 20px;
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        border-radius: 8px;
                    }
                    
                    .info-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                        margin-bottom: 20px;
                    }
                    
                    .info-item {
                        border: 1px solid #e8f4f8;
                        padding: 15px;
                        border-radius: 8px;
                        background: #fafcfd;
                    }
                    
                    .info-label {
                        font-weight: 600;
                        color: #2c6470;
                        margin-bottom: 5px;
                        font-size: 14px;
                    }
                    
                    .info-value {
                        color: #34495e;
                        font-size: 15px;
                        min-height: 20px;
                    }
                    
                    .full-width {
                        grid-column: 1 / -1;
                    }
                    
                    .text-content {
                        background: #f8fbfc;
                        padding: 20px;
                        border-radius: 8px;
                        border-right: 4px solid #4a90a4;
                        margin-bottom: 15px;
                    }
                    
                    .text-content .label {
                        font-weight: 600;
                        color: #2c6470;
                        font-size: 16px;
                        margin-bottom: 10px;
                        display: block;
                    }
                    
                    .text-content .content {
                        color: #34495e;
                        line-height: 1.8;
                        font-size: 15px;
                    }

                    .evidence-section {
                        background: #f8fbfc;
                        padding: 20px;
                        border-radius: 8px;
                        border-right: 4px solid #27ae60;
                        margin-bottom: 15px;
                        page-break-inside: avoid;
                    }

                    .evidence-section .label {
                        font-weight: 600;
                        color: #27ae60;
                        font-size: 16px;
                        margin-bottom: 15px;
                        display: block;
                    }

                    .evidence-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 20px;
                        margin-top: 15px;
                    }

                    .evidence-item {
                        text-align: center;
                        background: white;
                        padding: 15px;
                        border-radius: 12px;
                        border: 2px solid #e8f4f8;
                        page-break-inside: avoid;
                    }

                    .evidence-item img {
                        max-width: 100%;
                        height: 180px;
                        object-fit: cover;
                        border-radius: 8px;
                        margin-bottom: 10px;
                        border: 1px solid #ddd;
                    }

                    .evidence-item .file-icon {
                        font-size: 4em;
                        color: #4a90a4;
                        margin-bottom: 10px;
                    }

                    .evidence-item .file-name {
                        font-size: 14px;
                        color: #2c6470;
                        word-break: break-word;
                        font-weight: 500;
                    }

                    .evidence-summary {
                        background: #e8f8f5;
                        padding: 15px;
                        border-radius: 8px;
                        margin-top: 20px;
                        text-align: center;
                    }

                    .evidence-summary .count {
                        font-size: 24px;
                        font-weight: 700;
                        color: #27ae60;
                        margin-bottom: 5px;
                    }

                    .evidence-summary .label {
                        color: #2c6470;
                        font-weight: 500;
                    }
                    
                    .footer {
                        margin-top: 50px;
                        border-top: 2px solid #4a90a4;
                        padding-top: 30px;
                        page-break-inside: avoid;
                    }
                    
                    .signatures {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 50px;
                        margin-bottom: 30px;
                    }
                    
                    .signature-box {
                        text-align: center;
                        padding: 20px;
                        border: 1px solid #e8f4f8;
                        border-radius: 8px;
                        background: #fafcfd;
                    }
                    
                    .signature-title {
                        font-weight: 600;
                        color: #2c6470;
                        margin-bottom: 10px;
                        font-size: 16px;
                    }
                    
                    .signature-name {
                        color: #34495e;
                        margin-bottom: 20px;
                        font-size: 15px;
                    }
                    
                    .signature-line {
                        border-bottom: 2px solid #2c6470;
                        height: 40px;
                        margin-bottom: 10px;
                    }
                    
                    .date-info {
                        text-align: center;
                        color: #7f8c8d;
                        font-size: 14px;
                        margin-top: 20px;
                    }
                    
                    @media print {
                        body { margin: 0; }
                        .header { page-break-inside: avoid; }
                        .content-section { page-break-inside: avoid; }
                        .signatures { page-break-inside: avoid; }
                        .evidence-section { page-break-inside: avoid; }
                    }
                </style>
            </head>
            <body>
                <div class="header">
                    <h1>Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</h1>
                    <h2>ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…</h2>
                    <h3>Ù…ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¹ÙˆØ§Ù„ÙŠ</h3>
                    <h4>Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ</h4>
                </div>

                <div class="report-title">
                    <h2>${reportTitle}</h2>
                </div>

                <div class="content-section">
                    <div class="section-title">Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</div>
                    <div class="info-grid">
                        ${generateBasicInfoHTML(formData, currentMapping)}
                    </div>
                </div>

                <div class="content-section">
                    <div class="section-title">Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰</div>
                    ${generateDetailedContentHTML(formData, currentMapping)}
                </div>

                ${currentFiles.length > 0 ? `
                <div class="content-section">
                    <div class="evidence-section">
                        <span class="label">Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ ÙˆØ§Ù„Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ù…Ø¯Ø¹Ù…Ø© Ù„Ù„ØªÙ‚Ø±ÙŠØ±</span>
                        <div class="evidence-summary">
                            <div class="count">${currentFiles.length}</div>
                            <div class="label">Ù…Ù„Ù Ù…Ø±ÙÙ‚ ÙƒØ´Ø§Ù‡Ø¯</div>
                        </div>
                        <div class="evidence-grid">
                            ${generateEvidenceHTML(currentFiles)}
                        </div>
                    </div>
                </div>
                ` : ''}

                <div class="footer">
                    <div class="signatures">
                        <div class="signature-box">
                            <div class="signature-title">Ø±Ø§Ø¦Ø¯ Ø§Ù„Ù†Ø´Ø§Ø·</div>
                            <div class="signature-name">Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ø­Ø±Ø¨ÙŠ</div>
                            <div class="signature-line"></div>
                            <div>Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</div>
                        </div>
                        <div class="signature-box">
                            <div class="signature-title">Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</div>
                            <div class="signature-name"></div>
                            <div class="signature-line"></div>
                            <div>Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</div>
                        </div>
                    </div>
                    <div class="date-info">
                        Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ<br>
                        Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleDateString('ar-SA')}<br>
                        ØªÙ… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: ${new Date().toLocaleString('ar-SA')}<br>
                        Ø¹Ø¯Ø¯ Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ Ø§Ù„Ù…Ø±ÙÙ‚Ø©: ${currentFiles.length}
                    </div>
                </div>
            </body>
            </html>
            `;
        }

        function generateBasicInfoHTML(formData, mapping) {
            const basicFields = getBasicFields(mapping.order);
            let html = '';
            
            basicFields.forEach(fieldId => {
                if (formData[fieldId]) {
                    const label = mapping.labels[fieldId];
                    const value = formData[fieldId];
                    html += `
                        <div class="info-item">
                            <div class="info-label">${label}</div>
                            <div class="info-value">${value}</div>
                        </div>
                    `;
                }
            });
            
            return html;
        }

        function generateDetailedContentHTML(formData, mapping) {
            const detailedFields = getDetailedFields(mapping.order);
            let html = '';
            
            detailedFields.forEach(fieldId => {
                if (formData[fieldId] && formData[fieldId].trim()) {
                    const label = mapping.labels[fieldId];
                    const content = formData[fieldId];
                    html += `
                        <div class="text-content">
                            <span class="label">${label}:</span>
                            <div class="content">${content}</div>
                        </div>
                    `;
                }
            });
            
            return html;
        }

        function generateEvidenceHTML(files) {
            return files.map(file => {
                if (file.type.startsWith('image/')) {
                    return `
                        <div class="evidence-item">
                            <img src="${file.data}" alt="${file.name}">
                            <div class="file-name">${file.name}</div>
                        </div>
                    `;
                } else {
                    return `
                        <div class="evidence-item">
                            <div class="file-icon">ğŸ“„</div>
                            <div class="file-name">${file.name}</div>
                        </div>
                    `;
                }
            }).join('');
        }

        function getBasicFields(allFields) {
            return allFields.filter(field => 
                !field.includes('objectives') && 
                !field.includes('impact') && 
                !field.includes('evidence') &&
                !field.includes('challenges') &&
                !field.includes('interaction') &&
                !field.includes('achievement') &&
                !field.includes('strength') &&
                !field.includes('weakness') &&
                !field.includes('issues') &&
                !field.includes('plans') &&
                !field.includes('students')
            );
        }

        function getDetailedFields(allFields) {
            return allFields.filter(field => 
                field.includes('objectives') || 
                field.includes('impact') || 
                field.includes('evidence') ||
                field.includes('challenges') ||
                field.includes('interaction') ||
                field.includes('achievement') ||
                field.includes('strength') ||
                field.includes('weakness') ||
                field.includes('issues') ||
                field.includes('plans') ||
                field.includes('students')
            );
        }
        
        // Export to Excel functionality
        function exportToExcel() {
            if (!validateForm()) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù‚Ø¨Ù„ Ø§Ù„ØªØµØ¯ÙŠØ±', 'warning');
                return;
            }

            showNotification('Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ù…Ù„Ù Excel...', 'info');
            
            const currentMapping = fieldMappings[currentReportType];
            const formData = getCurrentFormData(currentMapping.order);
            const currentFiles = uploadedFiles[currentReportType] || [];
            
            let csvContent = "data:text/csv;charset=utf-8,\uFEFF";
            
            csvContent += "Ø§Ù„Ø­Ù‚Ù„,Ø§Ù„Ù‚ÙŠÙ…Ø©\n";
            
            currentMapping.order.forEach(fieldId => {
                if (formData[fieldId]) {
                    const label = currentMapping.labels[fieldId];
                    const value = formData[fieldId].replace(/,/g, 'ØŒ');
                    csvContent += `"${label}","${value}"\n`;
                }
            });

            if (currentFiles.length > 0) {
                csvContent += `"Ø¹Ø¯Ø¯ Ø§Ù„Ø´ÙˆØ§Ù‡Ø¯ Ø§Ù„Ù…Ø±ÙÙ‚Ø©","${currentFiles.length}"\n`;
                csvContent += `"Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ù„ÙØ§Øª","${currentFiles.map(f => f.name).join('ØŒ ')}"\n`;
            }
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            
            const reportTitle = document.getElementById('form-title').textContent;
            const fileName = `${reportTitle.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.csv`;
            link.setAttribute("download", fileName);
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
        }
        
        // Notification system
        function showNotification(message, type) {
            const colors = {
                'success': '#27ae60',
                'error': '#e74c3c',
                'warning': '#f39c12',
                'info': '#3498db'
            };
            
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${colors[type] || colors.info};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                z-index: 1000;
                font-weight: 500;
                max-width: 300px;
                animation: slideInRight 0.3s ease-out;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease-in';
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        // Event listeners and interactions
        window.onclick = function(event) {
            const modal = document.getElementById('reportModal');
            const imageModal = document.getElementById('imageModal');
            if (event.target == modal) {
                closeReportModal();
            }
            if (event.target == imageModal) {
                closeImageModal();
            }
        }

        // Image Modal Functions
        function openImageModal(imageSrc, imageName, imageSize) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const modalName = document.getElementById('modalImageName');
            const modalDetails = document.getElementById('modalImageDetails');
            
            modal.style.display = 'block';
            modalImg.src = imageSrc;
            modalName.textContent = imageName;
            modalDetails.textContent = `Ø§Ù„Ø­Ø¬Ù…: ${imageSize}`;
            
            // Add fade in animation
            modal.style.animation = 'fadeIn 0.3s ease-in';
        }

        function closeImageModal() {
            const modal = document.getElementById('imageModal');
            modal.style.animation = 'fadeOut 0.3s ease-out';
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
        }

        document.addEventListener('input', function(event) {
            if (event.target.matches('input, select, textarea')) {
                // Remove validation error styling when user starts typing
                event.target.classList.remove('form-validation-error');
                const errorElement = document.getElementById(event.target.id + '-error');
                if (errorElement) {
                    errorElement.style.display = 'none';
                }
                
                // Update form progress
                updateFormProgress();
            }
        });
        
        document.addEventListener('keydown', function(event) {
            if ((event.ctrlKey || event.metaKey) && event.key === 's') {
                event.preventDefault();
                generatePDF();
            }
            
            if ((event.ctrlKey || event.metaKey) && event.key === 'r') {
                event.preventDefault();
                clearForm();
            }
            
            if (event.key === 'Escape') {
                closeReportModal();
            }

            if ((event.ctrlKey || event.metaKey) && event.key === 'u') {
                event.preventDefault();
                const currentFileInput = getCurrentFileInput();
                if (currentFileInput) {
                    currentFileInput.click();
                }
            }
        });

        function getCurrentFileInput() {
            const fileInputMap = {
                'activity': 'evidence-files',
                'daily': 'daily-evidence-files',
                'weekly': 'weekly-evidence-files',
                'monthly': 'monthly-evidence-files'
            };
            return document.getElementById(fileInputMap[currentReportType]);
        }

        // Enhanced form interactions
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('input, select, textarea').forEach(field => {
                field.addEventListener('focus', function() {
                    this.parentElement.style.transform = 'translateY(-2px)';
                    this.style.boxShadow = '0 5px 15px rgba(74, 144, 164, 0.2)';
                });
                
                field.addEventListener('blur', function() {
                    this.parentElement.style.transform = 'translateY(0)';
                    this.style.boxShadow = 'none';
                });
            });

            // Add help tooltips for evidence sections
            const evidenceSections = document.querySelectorAll('.evidence-section');
            evidenceSections.forEach(section => {
                section.title = 'Ø§Ø³Ø­Ø¨ Ø§Ù„Ù…Ù„ÙØ§Øª Ù‡Ù†Ø§ Ù…Ø¨Ø§Ø´Ø±Ø© Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ctrl+U Ù„Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø¨Ø³Ø±Ø¹Ø©';
            });
        });

        // Auto-save functionality with file support
        function enableAutoSave() {
            setInterval(() => {
                const currentMapping = fieldMappings[currentReportType];
                const formData = getCurrentFormData(currentMapping.order);
                const currentFiles = uploadedFiles[currentReportType] || [];
                
                const hasData = Object.values(formData).some(value => value.trim() !== '') || currentFiles.length > 0;
                if (hasData) {
                    const autoSaveData = {
                        reportType: currentReportType,
                        data: formData,
                        files: currentFiles,
                        timestamp: new Date().toISOString(),
                        isAutoSave: true
                    };
                    
                    localStorage.setItem('autoSaveData', JSON.stringify(autoSaveData));
                }
            }, 30000); // Auto-save every 30 seconds
        }

        function loadAutoSaveData() {
            const autoSaveData = localStorage.getItem('autoSaveData');
            if (autoSaveData) {
                const data = JSON.parse(autoSaveData);
                const timeDiff = new Date() - new Date(data.timestamp);
                
                // If auto-save is less than 1 hour old
                if (timeDiff < 3600000) {
                    if (confirm('ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ±Ø¯Ø§Ø¯Ù‡Ø§ØŸ')) {
                        currentReportType = data.reportType;
                        
                        // Load the appropriate form
                        if (data.reportType !== 'activity') {
                            selectReportType(data.reportType);
                        }
                        
                        // Fill the form data
                        Object.entries(data.data).forEach(([fieldId, value]) => {
                            const field = document.getElementById(fieldId);
                            if (field) {
                                field.value = value;
                            }
                        });

                        // Restore uploaded files
                        if (data.files && data.files.length > 0) {
                            uploadedFiles[data.reportType] = data.files;
                            updateEvidencePreview(data.reportType);
                            stats.evidenceUploaded += data.files.length;
                        }
                        
                        updateFormProgress();
                        updateStats();
                        showNotification('ØªÙ… Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹', 'success');
                    }
                }
            }
        }

        // File size formatter
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Ø¨Ø§ÙŠØª';
            const k = 1024;
            const sizes = ['Ø¨Ø§ÙŠØª', 'ÙƒÙŠÙ„ÙˆØ¨Ø§ÙŠØª', 'Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª', 'Ø¬ÙŠØ¬Ø§Ø¨Ø§ÙŠØª'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Enhanced file preview with size info
        function updateEvidencePreview(reportType) {
            const previewId = reportType === 'activity' ? 'evidence-preview' : `${reportType}-evidence-preview`;
            const preview = document.getElementById(previewId);
            
            if (!preview) return;
            
            preview.innerHTML = '';
            
            uploadedFiles[reportType].forEach((file, index) => {
                const item = document.createElement('div');
                item.className = 'evidence-item';
                
                let content = '';
                if (file.type.startsWith('image/')) {
                    content = `<img src="${file.data}" alt="${file.name}">`;
                } else {
                    content = `<div style="height: 80px; display: flex; align-items: center; justify-content: center; background: #f8f9fa; color: #2c6470; font-size: 2em;">ğŸ“„</div>`;
                }
                
                item.innerHTML = `
                    ${content}
                    <div class="file-info">
                        <div style="font-weight: 500;">${file.name}</div>
                        <div style="font-size: 0.7em; color: #7f8c8d; margin-top: 2px;">${formatFileSize(file.size)}</div>
                    </div>
                    <button class="remove-btn" onclick="removeFile('${reportType}', ${index})" title="Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù">&times;</button>
                `;

                // Add click event for image preview
                if (file.type.startsWith('image/')) {
                    item.addEventListener('click', function(e) {
                        if (!e.target.classList.contains('remove-btn')) {
                            openImageModal(file.data, file.name, formatFileSize(file.size));
                        }
                    });
                }
                
                preview.appendChild(item);
            });

            // Show total files count and size
            if (uploadedFiles[reportType].length > 0) {
                const totalSize = uploadedFiles[reportType].reduce((sum, file) => sum + file.size, 0);
                const summary = document.createElement('div');
                summary.style.cssText = `
                    grid-column: 1 / -1;
                    text-align: center;
                    padding: 10px;
                    background: rgba(74, 144, 164, 0.1);
                    border-radius: 5px;
                    font-size: 0.9em;
                    color: #2c6470;
                `;
                summary.innerHTML = `
                    Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${uploadedFiles[reportType].length} Ù…Ù„Ù - ${formatFileSize(totalSize)}
                `;
                preview.appendChild(summary);
            }
        }

        // Initialize auto-save when page loads
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                loadAutoSaveData();
                enableAutoSave();
            }, 1000);
        });

        // Print functionality enhancement
        function printFormWithEvidence() {
            const htmlContent = generateHTMLForPDF();
            const printWindow = window.open('', '_blank');
            printWindow.document.write(htmlContent);
            printWindow.document.close();
            printWindow.focus();
            setTimeout(() => {
                printWindow.print();
            }, 1000);
        }

        // Keyboard shortcuts info
        function showKeyboardShortcuts() {
            const shortcuts = `
                Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­:
                â€¢ Ctrl+S: Ø­ÙØ¸ ÙƒÙ€ PDF
                â€¢ Ctrl+R: Ù…Ø³Ø­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                â€¢ Ctrl+U: Ø±ÙØ¹ Ù…Ù„ÙØ§Øª
                â€¢ Escape: Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
            `;
            showNotification(shortcuts, 'info');
        }

        // Add keyboard shortcut info button
        document.addEventListener('DOMContentLoaded', function() {
            const shortcutBtn = document.createElement('button');
            shortcutBtn.innerHTML = 'âŒ¨ï¸ Ø§Ø®ØªØµØ§Ø±Ø§Øª';
            shortcutBtn.className = 'btn secondary';
            shortcutBtn.style.cssText = `
                position: fixed;
                bottom: 20px;
                left: 20px;
                z-index: 999;
                font-size: 0.8em;
                padding: 8px 15px;
            `;
            shortcutBtn.onclick = showKeyboardShortcuts;
            document.body.appendChild(shortcutBtn);
        });

        // Context menu for evidence items
        document.addEventListener('contextmenu', function(event) {
            if (event.target.closest('.evidence-item')) {
                event.preventDefault();
                
                const menu = document.createElement('div');
                menu.style.cssText = `
                    position: fixed;
                    top: ${event.clientY}px;
                    left: ${event.clientX}px;
                    background: white;
                    border: 1px solid #ddd;
                    border-radius: 5px;
                    padding: 5px 0;
                    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                    z-index: 1000;
                `;
                
                const viewOption = document.createElement('div');
                viewOption.textContent = 'Ø¹Ø±Ø¶ Ø¨Ø­Ø¬Ù… ÙƒØ§Ù…Ù„';
                viewOption.style.cssText = `
                    padding: 8px 15px;
                    cursor: pointer;
                    font-size: 14px;
                `;
                viewOption.addEventListener('click', function() {
                    const img = event.target.closest('.evidence-item').querySelector('img');
                    if (img) {
                        window.open(img.src, '_blank');
                    }
                    document.body.removeChild(menu);
                });
                
                menu.appendChild(viewOption);
                document.body.appendChild(menu);
                
                document.addEventListener('click', function() {
                    if (document.body.contains(menu)) {
                        document.body.removeChild(menu);
                    }
                }, { once: true });
            }
        });
    </script>
</body>
</html>
