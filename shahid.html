<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„Ø³Ù„ÙˆÙƒÙŠØ© - Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap');
        body { font-family: 'Cairo', sans-serif; }
        .modal-backdrop { backdrop-filter: blur(4px); }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app"></div>

    <script>
        // ---------- Teachers ----------
        const teachersList = [
            'Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù…Ø·Ø± Ø¨Ù† Ù…ØµÙ„Ø­ Ø§Ù„Ø¹Ù…Ø±ÙŠ','Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø¹Ù…Ø§Ø±ÙŠ Ø±Ø§Ø¶ÙŠ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ','Ù…ÙˆÙÙ‚ Ù…Ø±Ø²ÙˆÙ‚ Ø³ÙˆÙŠØ±Ø­ Ø§Ù„Ø³Ø­ÙŠÙ…ÙŠ','ÙÙˆØ§Ø² Ø²Ø§ÙŠØ¯ Ù„Ø§ÙÙŠ Ø§Ù„Ù…Ù‡ÙŠÙ…Ø²ÙŠ Ø§Ù„Ø±Ø´ÙŠØ¯ÙŠ','ÙÙŠØµÙ„ Ø¹Ø·Ø§Ù„Ù„Ù‡ Ø­ÙˆÙŠÙ…Ø¯ Ø§Ù„ØµØ§Ø¹Ø¯ÙŠ','Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹ÙŠØ§Ø¯ Ø¹ÙŠØ¯ Ø§Ù„Ø¹Ù„ÙˆÙŠ','Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø­Ù…ÙˆØ¯ Ø­Ø§Ù…Ø¯ Ø§Ù„Ø­Ø±Ø¨ÙŠ','Ø³Ø§ÙŠØ± ÙÙŠØµÙ„ Ø³Ø¹Ø¯ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø¹Ø¶ÙŠÙ„Ù‡ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ','Ù†Ø§ÙØ¹ Ø´Ø¹ÙˆÙŠ Ù†Ø§ÙØ¹ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ','Ø§Ø³Ø§Ù…Ù‡ Ù…Ù†ÙˆØ± Ù…Ø´Ø¹Ù„ Ø§Ù„Ø¹ÙˆÙÙŠ','Ù…Ø­Ù…Ø¯ Ø¹ÙŠØ§Ø¯ Ø¹Ù„ÙŠØ«Ù‡ Ø§Ù„Ø¹ÙˆÙÙŠ','Ø£Ø­Ù…Ø¯ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… ÙØ®Ø±ÙŠ Ø§Ù„ØªØ±ÙƒÙŠ','Ø£Ø­Ù…Ø¯ Ø­Ø§Ù…Ø¯ Ù‡Ù„Ø§Ù„ Ø§Ù„Ø­Ø±Ø¨ÙŠ','Ù†Ù…ÙŠØ§Ù† Ø¹Ù„ÙŠ Ù†Ù…ÙŠØ§Ù† Ø§Ù„Ø­Ø±Ø¨ÙŠ','Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ ØµÙ„Ø§Ø­ ØµØ§Ù„Ø­ Ø§Ù„Ø±Ø­ÙŠÙ„Ù‰','Ù…Ø´Ø¹Ù„ Ø¨Ù† Ù‡Ù„ÙŠÙ„ Ø¨Ù† ØºØ§Ù„Ø¨ Ø§Ù„Ø¹Ù…Ø±ÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ','Ø¹Ù„ÙŠ Ù…ØªØ¹Ø¨ Ù†Ø§ØµØ± Ø§Ù„Ø¹Ù„ÙˆÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ','Ø³ÙŠÙ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ù†Ø¹Ù… Ø­Ù…Ø¯Ø§Ù† Ø§Ù„Ø¹Ø§Ø±Ø¶ÙŠ','Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø°Ø¹Ø§Ø± Ø¨Ù† ØµØ§Ù„Ø­ Ø§Ù„Ø¹ÙˆÙÙŠ','ÙØ¤Ø§Ø¯ Ø¨Ù† Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø­Ù…Ø§Ø¯ Ø§Ù„Ø¹ØªÙŠØ¨ÙŠ','Ø­Ù…Ø²Ø© ØµØ¯Ù‚Ø© Ø­Ù…Ø²Ø© Ø§Ø³Ù„Ø§Ù…','Ø³Ù„Ù…Ø§Ù† ØµØ§Ù„Ø­ Ø£Ø­Ù…Ø¯ Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ','Ø¹Ø¨ÙŠØ¯ Ø¨Ù† Ø¯Ø®ÙŠÙ„ Ø¨Ù† Ø¯ÙˆÙŠÙ‡ÙŠØ³ Ø§Ù„Ø¹ÙŠØ§Ø¶ÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ','Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ù…ÙÙ„Ø­ Ù†ÙˆÙŠØ¹Ù… Ø§Ù„Ø±ÙˆÙŠØ«ÙŠ','ÙÙŠØµÙ„ Ø¹ÙˆØ§Ø¯ Ù…Ø­Ù…Ø¯ Ø£Ø¨Ùˆ Ø³Ù„Ù…ÙŠ','Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø³Ø¹ÙŠØ¯ Ø§Ù„ Ø¨Ø­Ø±Ø§Ù† Ø§Ù„Ù‚Ø±Ù†ÙŠ','ÙƒØ§ØªØ¨ Ù…ÙÙ„Ø­ Ø³Ù„ÙŠÙ…Ø§Ù† Ø§Ù„Ø±Ø´ÙŠØ¯Ù‰','Ø­Ø¨ÙŠØ¨ Ø¹Ù„ÙŠ Ù†Ø¹ÙŠØ³ Ø§Ù„Ø¹Ù…Ø±ÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ','Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ø§ÙŠØ¶ Ø¹ÙˆØ¶ Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠ','Ø³Ù„Ø·Ø§Ù† Ø¹ÙˆÙŠØ¶ Ù…Ø¹ÙŠØ¶ Ø§Ù„Ø³Ø­ÙŠÙ…ÙŠ','Ø¹Ø¨Ø¯Ø§Ù„Ù‡Ø§Ø¯ÙŠ Ù…Ø¹ÙŠØ¶ Ù…Ø¹Ù„Ø§ Ø§Ù„Ø´Ø§Ù…Ø§Ù†ÙŠ','Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù† ØºÙ„Ø§Ø¨ Ø§Ù„Ù…Ø®Ù„ÙÙŠ','Ø³Ø¹Ø¯ Ø·Ø§Ù„Ø¹ Ø­Ù…ÙˆØ¯ Ø§Ù„Ø­Ø±Ø¨ÙŠ','Ù†Ø§Ù‡Ø± Ù…Ø´Ø¹Ù„ Ø¹ÙˆÙŠØ¯ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ','Ù…ÙˆØ³Ù‰ ØºØ§Ø²ÙŠ Ø³ÙØ± Ø§Ù„Ø­Ø±Ø¨ÙŠ','Ù…ÙˆØ³Ù‰ Ù…Ø³Ø¹ÙˆØ¯ Ø¹Ø§ÙŠØ¶ Ø§Ù„Ø­ÙŠØ³ÙˆÙ†ÙŠ','Ù†ÙˆØ§Ù Ù…Ù†ØµÙˆØ± Ø¹ÙˆØ§Ø¯ Ø§Ù„ØµØ¨Ø­ÙŠ','Ø¨Ø¯Ø± Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø´Ø§Ø¦Ø¯ Ø§Ù„Ø³Ø­ÙŠÙ…ÙŠ','ÙÙ‡Ø¯ Ø¹ÙˆÙŠØ¶ Ø¹ÙˆØ¶ Ø§Ù„Ø´Ø§Ù…Ø§Ù†ÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ','Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø¬ÙŠØ¯ Ø¹Ø§ÙŠØ¯ Ø®Ø¶Ø±Ø§Ù† Ø§Ù„Ø±Ø´ÙŠØ¯ÙŠ','Ø£Ø­Ù…Ø¯ Ù…Ø·Ø± Ø³Ù„ÙŠÙ…Ø§Ù† Ø§Ù„Ø±Ø´ÙŠØ¯ÙŠ'
        ];

        // ---------- Config ----------
        const config = {
            passwords: { principal:'A2030', assistant:'B2030', counselor:'C2030' },
            schoolInfo: { name:'Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ', principal:'Ø®Ø§Ù„Ø¯ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ', assistant:'Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠ', counselor:'Ù…Ø­Ù…Ø¯ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ', type:'Ø¨Ù†ÙŠÙ†' },
            grades: ['Ø£ÙˆÙ„ Ù…ØªÙˆØ³Ø·','Ø«Ø§Ù†ÙŠ Ù…ØªÙˆØ³Ø·','Ø«Ø§Ù„Ø« Ù…ØªÙˆØ³Ø·'],
            sections: ['1','2','3','4','5','6'],
            violationTypes: { /* same as before */ }
        };

        // ---------- Application State ----------
        let state = {
            currentUser: { role:'teacher', name:teachersList[0], id:1 },
            authenticated: { principal:false, assistant:false, counselor:false },
            violations: [/* same initial data */],
            studentActions: [],
            filters: { selectedTab:'all', searchStudent:'', filterGrade:'', filterSection:'', dateFrom:'', dateTo:'' },
            modals: { showAddForm:false, showDetailsModal:false, selectedViolation:null, showActionModal:false, selectedStudent:null },
            newViolation: { studentName:'', grade:'', section:'', violationType:'first', violationDetails:'', documentation:'', date:new Date().toISOString().split('T')[0], time:new Date().toTimeString().slice(0,5) }
        };

        // ---------- Absence Data ----------
        let absenceRecords = [];
        window.addEventListener('message', e => {
            if (e.data && e.data.type === 'absenceData') {
                absenceRecords = e.data.payload || [];
                if (state.currentUser.role === 'assistant') render();
            }
        });

        // ---------- Utility ----------
        function getFilteredViolations() { /* same logic */ }
        function getStats() { /* same */ }
        function render() {
            document.getElementById('app').innerHTML = `
                ${renderHeader()}
                ${renderUserTabs()}
                ${renderMainContent()}
                ${state.modals.showAddForm ? renderAddModal() : ''}
                ${state.modals.showDetailsModal ? renderDetailsModal() : ''}
                ${state.modals.showActionModal ? renderActionModal() : ''}
            `;
        }

        // ---------- Header ----------
        function renderHeader() {
            return `
            <div class="bg-gradient-to-br from-blue-600 via-blue-700 to-blue-800 text-white shadow-2xl">
                <div class="max-w-7xl mx-auto px-6 py-8">
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <h1 class="text-4xl font-bold mb-2">ğŸ“š ${config.schoolInfo.name}</h1>
                            <p class="text-blue-100 text-lg">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„Ø³Ù„ÙˆÙƒÙŠØ© - ${config.schoolInfo.type}</p>
                        </div>
                        <div class="text-left bg-blue-800 bg-opacity-50 rounded-lg p-4 backdrop-blur-sm">
                            <p class="text-sm text-blue-100 mb-1">ğŸ‘¤ Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©: ${config.schoolInfo.principal}</p>
                            <p class="text-sm text-blue-100 mb-1">ğŸ‘¤ Ø§Ù„ÙˆÙƒÙŠÙ„: ${config.schoolInfo.assistant}</p>
                            <p class="text-sm text-blue-100">ğŸ‘¤ Ø§Ù„Ù…ÙˆØ¬Ù‡ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ: ${config.schoolInfo.counselor}</p>
                        </div>
                    </div>
                </div>
            </div>`;
        }

        // ---------- Top Bar ----------
        function renderUserTabs() {
            const isActive = r => state.currentUser.role === r;
            const btn = (r,icon,label) => `<button onclick="setCurrentUser('${r}', '${config.schoolInfo[r]}', ${r==='teacher'?1:r==='assistant'?2:r==='counselor'?3:4})" class="flex items-center gap-2 px-6 py-3 rounded-lg font-medium transition-all ${isActive(r)?'bg-blue-600 text-white shadow-lg scale-105':'bg-gray-100 text-gray-700 hover:bg-gray-200'}">${icon} ${label}</button>`;

            return `
            <div class="bg-white border-b shadow-sm sticky top-0 z-40">
                <div class="max-w-7xl mx-auto px-6 py-4">
                    <div class="flex items-center justify-between flex-wrap gap-4">
                        <div class="flex gap-2 flex-wrap items-center">
                            ${state.currentUser.role==='teacher'?`
                                <select onchange="setCurrentUser('teacher', this.value, 1)" class="px-4 py-3 border-2 border-blue-600 rounded-lg focus:ring-2 focus:ring-blue-500 font-medium text-blue-900 bg-blue-50">
                                    ${teachersList.map(t=>`<option ${state.currentUser.name===t?'selected':''}>ğŸ‘¨â€ğŸ« ${t}</option>`).join('')}
                                </select>
                            `:btn('teacher','ğŸ‘¨â€ğŸ«','ØµÙØ­Ø© Ø§Ù„Ù…Ø¹Ù„Ù…')}
                            ${btn('assistant','ğŸ“‹','ØµÙØ­Ø© Ø§Ù„ÙˆÙƒÙŠÙ„')}
                            ${btn('counselor','ğŸ“¢','Ø§Ù„Ù…ÙˆØ¬Ù‡ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ')}
                            ${btn('principal','ğŸ›ï¸','ØµÙØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ±')}

                            <!-- âœ… Ø±Ø§Ø¨Ø· ØµÙØ­Ø© Ø§Ù„ØºÙŠØ§Ø¨ -->
                            <a href="https://nawafoooh.github.io/activity/absent.html"
                               class="px-4 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors shadow-md">
                               ğŸ“‹ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØºÙŠØ§Ø¨
                            </a>
                        </div>
                        <div class="bg-blue-50 px-4 py-2 rounded-lg border border-blue-200">
                            <p class="text-sm text-blue-900"><span class="font-bold">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ:</span> ${state.currentUser.name} - ${getRoleLabel(state.currentUser.role)}</p>
                        </div>
                    </div>
                </div>
            </div>`;
        }

        // ---------- Main Content ----------
        function renderMainContent() {
            const stats = getStats();
            const filtered = getFilteredViolations();
            return `
            <div class="max-w-7xl mx-auto px-6 py-6">
                ${renderStats(stats)}
                ${renderViolationsSection(filtered)}
                ${renderStudentsUnderWatch()}
                ${renderAbsenceBlock()}   <!-- âœ Ø¸Ù‡ÙˆØ± Ø§Ù„ØºÙŠØ§Ø¨ Ù„Ù„ÙˆÙƒÙŠÙ„ ÙÙ‚Ø· -->
            </div>`;
        }

        // ---------- Absence Block (ÙˆÙƒÙŠÙ„ only) ----------
        function renderAbsenceBlock() {
            if (state.currentUser.role !== 'assistant') return '';
            const filtered = absenceRecords.filter(a => {
                if (state.filters.filterGrade   && a.grade   !== state.filters.filterGrade)   return false;
                if (state.filters.filterSection && a.section !== state.filters.filterSection) return false;
                if (state.filters.dateFrom      && a.date    <  state.filters.dateFrom)       return false;
                if (state.filters.dateTo        && a.date    >  state.filters.dateTo)         return false;
                return true;
            });

            const printHandler = () => {
                const pw = window.open('', '_blank');
                pw.document.write(buildAbsencePrintPage(filtered));
                pw.document.close();
                pw.focus();
                pw.print();
            };

            return `
            <div class="bg-white rounded-xl shadow-lg p-6 mt-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-2xl font-bold text-gray-900 flex items-center gap-2">ğŸ“‹ Ø³Ø¬Ù„ Ø§Ù„ØºÙŠØ§Ø¨ (${filtered.length} Ø³Ø¬Ù„Ø§Øª)</h2>
                    <button onclick="(${printHandler})()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors shadow">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-3 py-2 text-right">#</th>
                                <th class="px-3 py-2 text-right">Ø§Ù„ØµÙ</th>
                                <th class="px-3 py-2 text-right">Ø§Ù„Ø´Ø¹Ø¨Ø©</th>
                                <th class="px-3 py-2 text-right">Ø§Ù„Ø­ØµØ©</th>
                                <th class="px-3 py-2 text-right">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th class="px-3 py-2 text-right">Ø¹Ø¯Ø¯ Ø§Ù„ØºÙŠØ§Ø¨</th>
                                <th class="px-3 py-2 text-right">Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ØºØ§Ø¦Ø¨ÙŠÙ†</th>
                                <th class="px-3 py-2 text-right">Ø§Ù„Ù…Ø¹Ù„Ù…</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y">
                            ${filtered.map((a,i)=>`
                            <tr class="hover:bg-gray-50">
                                <td>${i+1}</td>
                                <td class="font-medium">${a.grade}</td>
                                <td>${a.section}</td>
                                <td><span class="px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800">Ø§Ù„Ø­ØµØ© ${a.period}</span></td>
                                <td>${a.date}</td>
                                <td class="text-red-600 font-bold">${a.absentCount}</td>
                                <td class="max-w-xs"><div class="bg-yellow-50 border border-yellow-200 rounded p-2 text-xs">${a.absentStudents?.slice(0,3).map((s,j)=>`${j+1}. ${s}`).join('<br>')}${a.absentStudents.length>3?`<div class="text-blue-600 font-bold mt-1">... Ùˆ ${a.absentStudents.length-3} Ø¢Ø®Ø±ÙˆÙ†</div>`:''}</div></td>
                                <td>${a.teacherName}</td>
                            </tr>`).join('')}
                        </tbody>
                    </table>
                    ${filtered.length===0?'<p class="text-center py-8 text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª ØºÙŠØ§Ø¨ Ø¶Ù…Ù† Ø§Ù„ÙÙ„Ø§ØªØ± Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</p>':''}
                </div>
            </div>`;
        }

        // ---------- Print Absence ----------
        function buildAbsencePrintPage(list) {
            const today = new Date().toLocaleDateString('ar-SA');
            return `
            <!DOCTYPE html>
            <html lang="ar" dir="rtl">
            <head>
                <meta charset="UTF-8">
                <title>ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØºÙŠØ§Ø¨ - ${today}</title>
                <style>
                    @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap');
                    body{font-family:'Cairo',sans-serif;padding:40px;color:#111}
                    h1{text-align:center;margin-bottom:30px;color:#1e40af}
                    table{width:100%;border-collapse:collapse;margin-top:20px}
                    th,td{padding:8px 12px;border:1px solid #ccc;text-align:right}
                    th{background:#f3f4f6}
                    .foot{display:flex;justify-content:space-between;margin-top:50px}
                    .sign{width:200px;text-align:center;border-top:2px solid #000;padding-top:10px}
                    @media print{button.no-print{display:none}}
                </style>
            </head>
            <body>
                <h1>ğŸ“‹ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØºÙŠØ§Ø¨ Ø§Ù„ÙŠÙˆÙ…ÙŠ<br><small>${config.schoolInfo.name} - ${today}</small></h1>
                <table>
                    <thead><tr>
                        <th>#</th><th>Ø§Ù„ØµÙ</th><th>Ø§Ù„Ø´Ø¹Ø¨Ø©</th><th>Ø§Ù„Ø­ØµØ©</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                        <th>Ø¹Ø¯Ø¯ Ø§Ù„ØºÙŠØ§Ø¨</th><th>Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„ØºØ§Ø¦Ø¨ÙŠÙ†</th><th>Ø§Ù„Ù…Ø¹Ù„Ù…</th>
                    </tr></thead>
                    <tbody>
                    ${list.map((a,i)=>`
                        <tr>
                            <td>${i+1}</td><td>${a.grade}</td><td>${a.section}</td>
                            <td>Ø§Ù„Ø­ØµØ© ${a.period}</td><td>${a.date}</td>
                            <td>${a.absentCount}</td>
                            <td>${a.absentStudents?.join(' ØŒ ')}</td>
                            <td>${a.teacherName}</td>
                        </tr>`).join('')}
                    </tbody>
                </table>
                <div class="foot">
                    <div class="sign">Ø§Ù„ÙˆÙƒÙŠÙ„</div>
                    <div class="sign">Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</div>
                </div>
                <button class="no-print" onclick="window.print()" style="margin:30px auto;display:block;padding:10px 30px;background:#2563eb;color:#fff;border:none;border-radius:6px;cursor:pointer">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
            </body>
            </html>`;
        }

        // ---------- Other Helpers ----------
        function getRoleLabel(r){const m={teacher:'Ø§Ù„Ù…Ø¹Ù„Ù…',assistant:'Ø§Ù„ÙˆÙƒÙŠÙ„',counselor:'Ø§Ù„Ù…ÙˆØ¬Ù‡ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ',principal:'Ø§Ù„Ù…Ø¯ÙŠØ±'};return m[r]}
        function renderStats(s){/* same */ return ``}
        function renderViolationsSection(f){/* same */ return ``}
        function renderStudentsUnderWatch(){/* same */ return ``}
        function renderAddModal(){/* same */ return ``}
        function renderDetailsModal(){/* same */ return ``}
        function renderActionModal(){/* same */ return ``}
        function setCurrentUser(r,n,i){/* same */}

        // ---------- Initial Render ----------
        render();
    </script>
</body>
</html>
