<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø± Ø§ØªØµØ§Ù„ Firebase</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 600px;
            width: 100%;
        }
        
        h1 {
            color: #4F46E5;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .test-item {
            background: #F9FAFB;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border-left: 4px solid #E5E7EB;
        }
        
        .test-item.success {
            border-left-color: #10B981;
            background: #D1FAE5;
        }
        
        .test-item.error {
            border-left-color: #EF4444;
            background: #FEE2E2;
        }
        
        .test-item.pending {
            border-left-color: #F59E0B;
            background: #FEF3C7;
        }
        
        .test-title {
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .test-message {
            color: #6B7280;
            font-size: 14px;
        }
        
        .status-icon {
            font-size: 24px;
            margin-left: 10px;
        }
        
        .project-info {
            background: #EEF2FF;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .project-info h2 {
            color: #4F46E5;
            margin-bottom: 10px;
        }
        
        .project-info p {
            color: #6B7280;
            font-size: 14px;
        }
        
        button {
            background: #4F46E5;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            margin-top: 20px;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #4338CA;
        }
        
        button:disabled {
            background: #9CA3AF;
            cursor: not-allowed;
        }
        
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="project-info">
            <h2>ğŸ“ Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø°ÙƒÙŠ</h2>
            <p>Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: <strong>naj7-7da9d</strong></p>
            <p>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Firebase</p>
        </div>

        <h1>ğŸ”Œ Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„</h1>

        <div id="firebase-test" class="test-item pending">
            <div class="test-title">
                <span class="status-icon">â³</span>
                1. Firebase SDK
            </div>
            <div class="test-message">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</div>
        </div>

        <div id="auth-test" class="test-item pending">
            <div class="test-title">
                <span class="status-icon">â³</span>
                2. Authentication
            </div>
            <div class="test-message">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</div>
        </div>

        <div id="firestore-test" class="test-item pending">
            <div class="test-title">
                <span class="status-icon">â³</span>
                3. Firestore Database
            </div>
            <div class="test-message">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</div>
        </div>

        <div id="storage-test" class="test-item pending">
            <div class="test-title">
                <span class="status-icon">â³</span>
                4. Storage
            </div>
            <div class="test-message">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</div>
        </div>

        <button id="test-btn" onclick="runTests()">
            <span id="btn-text">ğŸ§ª Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</span>
        </button>
    </div>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, getDocs } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getStorage, ref, listAll } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js';

        // Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyBaY75jwos44EbgZMlhIcU_YfrGeKY7r3w",
            authDomain: "naj7-7da9d.firebaseapp.com",
            projectId: "naj7-7da9d",
            storageBucket: "naj7-7da9d.firebasestorage.app",
            messagingSenderId: "72751584563",
            appId: "1:72751584563:web:8562f042882919d2c4da46"
        };

        let app, auth, db, storage;

        function updateStatus(elementId, status, message) {
            const element = document.getElementById(elementId);
            element.className = `test-item ${status}`;
            
            const icon = status === 'success' ? 'âœ…' : status === 'error' ? 'âŒ' : 'â³';
            element.querySelector('.status-icon').textContent = icon;
            element.querySelector('.test-message').textContent = message;
        }

        async function runTests() {
            const btn = document.getElementById('test-btn');
            const btnText = document.getElementById('btn-text');
            
            btn.disabled = true;
            btnText.innerHTML = '<span class="spinner"></span> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...';

            try {
                // Test 1: Firebase SDK
                updateStatus('firebase-test', 'pending', 'Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Firebase...');
                await new Promise(resolve => setTimeout(resolve, 500));
                
                app = initializeApp(firebaseConfig);
                updateStatus('firebase-test', 'success', 'ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­! âœ“');

                // Test 2: Authentication
                updateStatus('auth-test', 'pending', 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Authentication...');
                await new Promise(resolve => setTimeout(resolve, 500));
                
                auth = getAuth(app);
                if (auth) {
                    updateStatus('auth-test', 'success', 'Authentication Ø¬Ø§Ù‡Ø²! ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ¹ÙŠÙ„ Email/Password ÙÙŠ Console');
                } else {
                    updateStatus('auth-test', 'error', 'ÙØ´Ù„ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Authentication');
                }

                // Test 3: Firestore
                updateStatus('firestore-test', 'pending', 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Firestore...');
                await new Promise(resolve => setTimeout(resolve, 500));
                
                db = getFirestore(app);
                
                try {
                    // Ù…Ø­Ø§ÙˆÙ„Ø© Ù‚Ø±Ø§Ø¡Ø© collection
                    const subjectsRef = collection(db, 'subjects');
                    const snapshot = await getDocs(subjectsRef);
                    
                    if (snapshot.empty) {
                        updateStatus('firestore-test', 'success', 
                            'Firestore Ù…ØªØµÙ„! âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª - Ø§Ø³ØªØ®Ø¯Ù… add-sample-data.html Ù„Ø¥Ø¶Ø§ÙØªÙ‡Ø§');
                    } else {
                        updateStatus('firestore-test', 'success', 
                            `Firestore Ø¬Ø§Ù‡Ø²! ÙˆØ¬Ø¯Ù†Ø§ ${snapshot.size} Ù…ÙˆØ§Ø¯ Ø¯Ø±Ø§Ø³ÙŠØ© âœ“`);
                    }
                } catch (error) {
                    if (error.code === 'permission-denied') {
                        updateStatus('firestore-test', 'error', 
                            'Firestore Ù…ÙˆØ¬ÙˆØ¯ Ù„ÙƒÙ† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø±ÙÙˆØ¶Ø© - ØºÙŠÙ‘Ø± Rules Ø¥Ù„Ù‰ Test Mode');
                    } else {
                        updateStatus('firestore-test', 'error', 
                            'ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ù†Ø´Ø§Ø¡ Firestore Database ÙÙŠ Console');
                    }
                }

                // Test 4: Storage
                updateStatus('storage-test', 'pending', 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Storage...');
                await new Promise(resolve => setTimeout(resolve, 500));
                
                storage = getStorage(app);
                
                try {
                    const storageRef = ref(storage, 'lessons');
                    await listAll(storageRef);
                    updateStatus('storage-test', 'success', 'Storage Ø¬Ø§Ù‡Ø²! Ø§Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª ÙˆØ§Ù„ØµÙˆØ±');
                } catch (error) {
                    if (error.code === 'storage/unauthorized') {
                        updateStatus('storage-test', 'error', 
                            'Storage Ù…ÙˆØ¬ÙˆØ¯ Ù„ÙƒÙ† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…Ø±ÙÙˆØ¶Ø© - ØºÙŠÙ‘Ø± Rules Ø¥Ù„Ù‰ Test Mode');
                    } else {
                        updateStatus('storage-test', 'success', 
                            'Storage Ù…ØªØµÙ„! Ù…Ø¬Ù„Ø¯ lessons ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø¹Ø¯');
                    }
                }

            } catch (error) {
                console.error('Test error:', error);
                updateStatus('firebase-test', 'error', `Ø®Ø·Ø£: ${error.message}`);
            } finally {
                btn.disabled = false;
                btnText.textContent = 'ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±';
            }
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        window.addEventListener('load', runTests);
        window.runTests = runTests;
    </script>
</body>
</html>
