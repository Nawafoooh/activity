<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ - Ù…Ù†ØµØ© ØªÙˆØ§ØµÙ„ Ø¢Ù…Ù†</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Tajawal', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; color: #333; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .header { background: white; padding: 20px 30px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); display: flex; justify-content: space-between; align-items: center; }
        .logo { display: flex; align-items: center; gap: 15px; }
        .logo-icon { width: 50px; height: 50px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .user-info { text-align: right; }
        .user-id { background: linear-gradient(135deg, #20bf6b 0%, #26de81 100%); color: white; padding: 8px 20px; border-radius: 20px; font-weight: 700; font-size: 14px; margin-bottom: 5px; display: inline-block; }
        .btn-logout { background: #dc3545; color: white; padding: 8px 20px; border-radius: 20px; border: none; font-weight: 600; cursor: pointer; font-family: 'Tajawal', sans-serif; font-size: 14px; margin-top: 10px; }
        .welcome-banner { background: white; padding: 40px; border-radius: 20px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); text-align: center; }
        .welcome-banner h1 { color: #667eea; font-size: 32px; margin-bottom: 10px; }
        .tabs { background: white; padding: 15px 30px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); display: flex; gap: 15px; overflow-x: auto; }
        .tab-btn { padding: 12px 30px; background: transparent; border: none; border-radius: 10px; font-family: 'Tajawal', sans-serif; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; white-space: nowrap; }
        .tab-btn.active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .dashboard-grid { display: grid; grid-template-columns: 1fr 2fr; gap: 30px; margin-bottom: 30px; }
        @media (max-width: 968px) { .dashboard-grid { grid-template-columns: 1fr; } }
        .card { background: white; border-radius: 20px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .card h2 { color: #667eea; margin-bottom: 25px; font-size: 24px; display: flex; align-items: center; gap: 10px; }
        .action-btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 15px; display: flex; align-items: center; gap: 15px; margin-bottom: 15px; transition: all 0.3s; border: none; width: 100%; cursor: pointer; font-family: 'Tajawal', sans-serif; font-size: 16px; text-align: right; }
        .action-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4); }
        .action-icon { font-size: 32px; width: 50px; height: 50px; background: rgba(255,255,255,0.2); border-radius: 10px; display: flex; align-items: center; justify-content: center; }
        .report-item { background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 15px; border-right: 4px solid #667eea; }
        .report-header { display: flex; justify-content: space-between; margin-bottom: 10px; }
        .report-badge { padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }
        .badge-new { background: #d4edda; color: #155724; }
        .badge-progress { background: #fff3cd; color: #856404; }
        .badge-resolved { background: #cce5ff; color: #004085; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 2000; align-items: center; justify-content: center; overflow-y: auto; padding: 20px; }
        .modal.active { display: flex; }
        .modal-content { background: white; border-radius: 20px; padding: 40px; width: 90%; max-width: 700px; max-height: 90vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 2px solid #f0f0f0; }
        .modal-header h2 { color: #667eea; font-size: 24px; }
        .btn-close { background: #f0f0f0; border: none; width: 35px; height: 35px; border-radius: 50%; font-size: 20px; cursor: pointer; }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; color: #333; font-weight: 600; font-size: 14px; }
        select, input, textarea { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 15px; font-family: 'Tajawal', sans-serif; }
        textarea { min-height: 120px; resize: vertical; }
        .btn-submit { width: 100%; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 10px; font-size: 18px; font-weight: 700; cursor: pointer; font-family: 'Tajawal', sans-serif; }
        .empty-state { text-align: center; padding: 60px 20px; color: #999; }
        #loginSection { max-width: 600px; margin: 50px auto; background: white; padding: 50px; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        #loginSection h1 { color: #667eea; text-align: center; margin-bottom: 30px; }
        .logo-login { width: 80px; height: 80px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 20px; display: flex; align-items: center; justify-content: center; font-size: 40px; margin: 0 auto 20px; }
        .consent-box { background: #f8f9fa; padding: 25px; border-radius: 15px; margin: 25px 0; border: 2px solid #667eea; }
        .consent-box h3 { color: #667eea; margin-bottom: 15px; font-size: 20px; }
        .consent-box ul { margin: 15px 0 15px 25px; line-height: 2; }
        .consent-box ul li { margin: 10px 0; }
        .checkbox-group { display: flex; align-items: start; gap: 10px; margin: 15px 0; }
        .checkbox-group input[type="checkbox"] { width: auto; margin-top: 5px; min-width: 20px; min-height: 20px; }
        .checkbox-group label { margin: 0; font-size: 14px; line-height: 1.6; }
        .privacy-link { color: #667eea; text-decoration: underline; cursor: pointer; }
        .privacy-link:hover { color: #764ba2; }
        .alert-box { background: #fff3cd; border: 2px solid #ffc107; color: #856404; padding: 20px; border-radius: 10px; margin: 20px 0; }
        .alert-box strong { display: block; margin-bottom: 10px; font-size: 18px; }
        .signature-pad { border: 2px solid #e0e0e0; border-radius: 10px; margin: 15px 0; background: white; }
        .signature-actions { display: flex; gap: 10px; margin-top: 10px; }
        .btn-clear { background: #6c757d; color: white; padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-family: 'Tajawal', sans-serif; }
        .emergency-notice { background: #dc3545; color: white; padding: 20px; border-radius: 15px; margin: 20px 0; }
        .emergency-notice h4 { margin-bottom: 10px; font-size: 18px; }
        .emergency-contacts { background: white; padding: 20px; border-radius: 10px; margin-top: 15px; }
        .emergency-contacts div { color: #333; margin: 8px 0; font-weight: 600; }
        .privacy-notice { background: #e7f3ff; border: 2px solid #667eea; padding: 25px; border-radius: 15px; margin: 20px 0; }
        .privacy-notice h3 { color: #667eea; margin-bottom: 15px; }
        .privacy-notice p { line-height: 1.8; margin: 10px 0; color: #333; }
        .step-indicator { display: flex; justify-content: center; gap: 10px; margin: 30px 0; }
        .step { width: 12px; height: 12px; border-radius: 50%; background: #e0e0e0; }
        .step.active { background: #667eea; }
        .step.completed { background: #20bf6b; }
    </style>
</head>
<body>
    <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù…Ø¹ Ù…ÙˆØ§ÙÙ‚Ø© ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± -->
    <div id="loginSection">
        <div class="logo-login">ğŸ›¡ï¸</div>
        <h1>Ù…Ù†ØµØ© ØªÙˆØ§ØµÙ„ Ø¢Ù…Ù†</h1>
        <h2 style="text-align: center; color: #666; font-size: 18px; margin-bottom: 30px;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨</h2>
        
        <div class="step-indicator">
            <div class="step active" id="step1"></div>
            <div class="step" id="step2"></div>
            <div class="step" id="step3"></div>
        </div>
        
        <!-- Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ -->
        <form id="studentInfoForm" style="display: block;">
            <div class="form-group">
                <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø·Ø§Ù„Ø¨ *</label>
                <input type="text" id="studentName" required>
            </div>
            
            <div class="form-group">
                <label>Ø§Ù„ØµÙ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ *</label>
                <select id="grade" required>
                    <option value="">-- Ø§Ø®ØªØ± Ø§Ù„ØµÙ --</option>
                    <option value="Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ">Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
                    <option value="Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ">Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
                    <option value="Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ">Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
                    <option value="Ø§Ù„Ø±Ø§Ø¨Ø¹ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ">Ø§Ù„Ø±Ø§Ø¨Ø¹ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
                    <option value="Ø§Ù„Ø®Ø§Ù…Ø³ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ">Ø§Ù„Ø®Ø§Ù…Ø³ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
                    <option value="Ø§Ù„Ø³Ø§Ø¯Ø³ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ">Ø§Ù„Ø³Ø§Ø¯Ø³ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</option>
                    <option value="Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ù…ØªÙˆØ³Ø·">Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ù…ØªÙˆØ³Ø·</option>
                    <option value="Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ù…ØªÙˆØ³Ø·">Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ù…ØªÙˆØ³Ø·</option>
                    <option value="Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ù…ØªÙˆØ³Ø·">Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ù…ØªÙˆØ³Ø·</option>
                    <option value="Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ">Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                    <option value="Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ">Ø§Ù„Ø«Ø§Ù†ÙŠ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                    <option value="Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ">Ø§Ù„Ø«Ø§Ù„Ø« Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù„Ù„Ø·Ø§Ù„Ø¨ *</label>
                <input type="text" id="studentId" pattern="[0-9]{10}" maxlength="10" placeholder="10 Ø£Ø±Ù‚Ø§Ù…" required>
            </div>
            
            <button type="submit" class="btn-submit">Ø§Ù„ØªØ§Ù„ÙŠ</button>
        </form>
        
        <!-- Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± -->
        <form id="guardianInfoForm" style="display: none;">
            <div class="alert-box">
                <strong>âš ï¸ ØªÙ†Ø¨ÙŠÙ‡ Ù…Ù‡Ù…</strong>
                ÙŠØ¬Ø¨ Ø¹Ù„Ù‰ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± Ø¥ÙƒÙ…Ø§Ù„ Ù‡Ø°Ø§ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙˆØ§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ù†ØµØ©
            </div>
            
            <div class="form-group">
                <label>Ø§Ø³Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± *</label>
                <input type="text" id="guardianName" required>
            </div>
            
            <div class="form-group">
                <label>Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ù„ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± *</label>
                <input type="text" id="guardianId" pattern="[0-9]{10}" maxlength="10" placeholder="10 Ø£Ø±Ù‚Ø§Ù…" required>
            </div>
            
            <div class="form-group">
                <label>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ *</label>
                <input type="tel" id="guardianPhone" pattern="05[0-9]{8}" placeholder="05XXXXXXXX" required>
            </div>
            
            <div class="form-group">
                <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                <input type="email" id="guardianEmail">
            </div>
            
            <div class="form-group">
                <label>ØµÙ„Ø© Ø§Ù„Ù‚Ø±Ø§Ø¨Ø© *</label>
                <select id="guardianRelation" required>
                    <option value="">-- Ø§Ø®ØªØ± --</option>
                    <option value="ÙˆØ§Ù„Ø¯">ÙˆØ§Ù„Ø¯</option>
                    <option value="ÙˆØ§Ù„Ø¯Ø©">ÙˆØ§Ù„Ø¯Ø©</option>
                    <option value="ÙˆØµÙŠ Ù‚Ø§Ù†ÙˆÙ†ÙŠ">ÙˆØµÙŠ Ù‚Ø§Ù†ÙˆÙ†ÙŠ</option>
                </select>
            </div>
            
            <button type="submit" class="btn-submit">Ø§Ù„ØªØ§Ù„ÙŠ</button>
            <button type="button" class="btn-submit" style="background: #6c757d; margin-top: 10px;" onclick="prevStep(1)">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
        </form>
        
        <!-- Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© ÙˆØ§Ù„Ø®ØµÙˆØµÙŠØ© -->
        <div id="consentForm" style="display: none;">
            <div class="privacy-notice">
                <h3>ğŸ“‹ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø®ØµÙˆØµÙŠØ©</h3>
                <p><strong>Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„Ø©:</strong> ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… - Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©</p>
                <p><strong>Ø§Ù„ØºØ±Ø¶ Ù…Ù† Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</strong> ØªÙˆÙÙŠØ± Ø¨ÙŠØ¦Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¢Ù…Ù†Ø©ØŒ Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠØŒ ÙˆØ§Ù„ØªØ¯Ø®Ù„ Ø§Ù„Ù…Ø¨ÙƒØ± Ù„Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø·Ù„Ø§Ø¨ Ù…Ù† Ø§Ù„ØªÙ†Ù…Ø± ÙˆØ§Ù„ØªØ­Ø±Ø´ ÙˆØ§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù†ÙØ³ÙŠØ© ÙˆØ§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©.</p>
                <p><strong>Ù…Ø¯Ø© Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</strong> Ø·ÙˆØ§Ù„ ÙØªØ±Ø© Ø§Ù„Ø¯Ø±Ø§Ø³Ø© + 3 Ø³Ù†ÙˆØ§Øª Ø¨Ø¹Ø¯ Ø§Ù„ØªØ®Ø±Ø¬ ÙˆÙÙ‚Ø§Ù‹ Ù„Ø³ÙŠØ§Ø³Ø© ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ….</p>
                <p><a href="#" class="privacy-link" onclick="showFullPrivacy(); return false;">Ø§Ù‚Ø±Ø£ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©</a></p>
            </div>
            
            <div class="consent-box">
                <h3>ğŸ”’ Ù†Ø·Ø§Ù‚ Ù…ÙˆØ§ÙÙ‚Ø© ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±</h3>
                <p><strong>Ø£Ù†Ø§ (ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±) Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰:</strong></p>
                <ul>
                    <li>Ø¬Ù…Ø¹ ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„ØªØ§Ù„ÙŠØ©: (Ø§Ù„Ø§Ø³Ù…ØŒ Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©ØŒ Ø§Ù„ØµÙØŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„)</li>
                    <li>Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©: (Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª Ø§Ù„Ø³Ù„ÙˆÙƒÙŠØ©ØŒ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†ÙØ³ÙŠØ©ØŒ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©) Ø¨Ø³Ø±ÙŠØ© ØªØ§Ù…Ø©</li>
                    <li>Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ù…Ø±Ø´Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ ÙÙ‚Ø·</li>
                    <li>ØªØµØ¹ÙŠØ¯ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø®Ø·Ø±Ø© (Ø¥ÙŠØ°Ø§Ø¡/ØªØ­Ø±Ø´) Ù„Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ø³Ù…ÙŠØ© (Ø§Ù„Ø´Ø±Ø·Ø© 911ØŒ Ù…Ø±ÙƒØ² Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª 1919ØŒ ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ ÙˆØ§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©)</li>
                    <li>ØªØ´ÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ­Ù…Ø§ÙŠØªÙ‡Ø§ ÙˆÙÙ‚ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ (SDAIA)</li>
                </ul>
            </div>
            
            <div class="emergency-notice">
                <h4>ğŸš¨ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·Ø§Ø±Ø¦Ø©</h4>
                <p style="margin: 10px 0;">ÙÙŠ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¥ÙŠØ°Ø§Ø¡ØŒ Ø§Ù„ØªØ­Ø±Ø´ØŒ Ø£Ùˆ Ø§Ù„Ø®Ø·Ø± Ø§Ù„Ø¬Ø³ÙŠÙ…ØŒ Ø³ÙŠØªÙ…:</p>
                <div class="emergency-contacts">
                    <div>â€¢ Ø§Ù„ØªØµØ¹ÙŠØ¯ Ø§Ù„ÙÙˆØ±ÙŠ Ù„Ù„Ù…Ø±Ø´Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</div>
                    <div>â€¢ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø§Ù„ÙÙˆØ±ÙŠ Ù„Ù„Ø´Ø±Ø·Ø©: 911</div>
                    <div>â€¢ Ù…Ø±ÙƒØ² Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª Ø§Ù„ÙˆØ·Ù†ÙŠ: 1919</div>
                    <div>â€¢ ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ ÙˆØ§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©: 19911</div>
                    <div>â€¢ ØªÙˆØ«ÙŠÙ‚ ÙƒØ§Ù…Ù„ Ù„Ù„Ø­Ø§Ù„Ø© ÙÙŠ Ø³Ø¬Ù„Ø§Øª Ù…Ø´ÙØ±Ø©</div>
                </div>
            </div>
            
            <div class="consent-box">
                <h3>âœ… Ø­Ù‚ÙˆÙ‚ ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± ÙˆØ§Ù„Ø·Ø§Ù„Ø¨</h3>
                <ul>
                    <li>Ø§Ù„Ø­Ù‚ ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª</li>
                    <li>Ø§Ù„Ø­Ù‚ ÙÙŠ ØªØµØ­ÙŠØ­ Ø£Ùˆ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</li>
                    <li>Ø§Ù„Ø­Ù‚ ÙÙŠ Ø³Ø­Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© ÙˆØ­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø¥Ù„Ø§ Ù…Ø§ ØªØªØ·Ù„Ø¨Ù‡ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©)</li>
                    <li>Ø§Ù„Ø­Ù‚ ÙÙŠ ØªÙ‚Ø¯ÙŠÙ… Ø´ÙƒÙˆÙ‰ Ù„Ø¯Ù‰ Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</li>
                    <li>Ø§Ù„Ø­Ù‚ ÙÙŠ Ù…Ø¹Ø±ÙØ© Ù…Ù† ÙŠØ·Ù„Ø¹ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨</li>
                </ul>
            </div>
            
            <form id="finalConsentForm">
                <div class="checkbox-group">
                    <input type="checkbox" id="consentData" required>
                    <label for="consentData">Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø¬Ù…Ø¹ ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ø¨Ù†ÙŠ/Ø§Ø¨Ù†ØªÙŠ ÙˆÙÙ‚Ø§Ù‹ Ù„Ù„ØºØ±Ø¶ Ø§Ù„Ù…Ø°ÙƒÙˆØ± Ø£Ø¹Ù„Ø§Ù‡</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="consentSensitive" required>
                    <label for="consentSensitive">Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø© (Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª Ø§Ù„Ø³Ù„ÙˆÙƒÙŠØ© ÙˆØ§Ù„Ù†ÙØ³ÙŠØ©) ÙˆØ£Ø¯Ø±Ùƒ Ø£Ù†Ù‡Ø§ Ø³ØªÙØ­ÙØ¸ Ø¨Ø³Ø±ÙŠØ© ØªØ§Ù…Ø©</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="consentEmergency" required>
                    <label for="consentEmergency">Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ ØªØµØ¹ÙŠØ¯ Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø®Ø·Ø±Ø© Ù„Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ø³Ù…ÙŠØ© (Ø§Ù„Ø´Ø±Ø·Ø©ØŒ Ù…Ø±ÙƒØ² Ø§Ù„Ø¨Ù„Ø§ØºØ§ØªØŒ ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©) Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©</label>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="consentPrivacy" required>
                    <label for="consentPrivacy">Ù‚Ø±Ø£Øª ÙˆÙÙ‡Ù…Øª <a href="#" class="privacy-link" onclick="showFullPrivacy(); return false;">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a> ÙˆØ£ÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§</label>
                </div>
                
                <div class="form-group" style="margin-top: 30px;">
                    <label>Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± (Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„) *</label>
                    <input type="text" id="guardianSignature" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ Ù„ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±" required>
                    <div style="font-size: 12px; color: #666; margin-top: 5px;">
                        Ø§Ù„ØªØ§Ø±ÙŠØ®: <span id="consentDate"></span>
                    </div>
                </div>
                
                <button type="submit" class="btn-submit">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„</button>
                <button type="button" class="btn-submit" style="background: #6c757d; margin-top: 10px;" onclick="prevStep(2)">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
            </form>
        </div>
    </div>
    
    <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
    <div id="dashboardSection" style="display: none;">
        <div class="container">
            <div class="header">
                <div class="logo">
                    <div class="logo-icon">ğŸ›¡ï¸</div>
                    <div><strong style="color: #667eea; font-size: 18px;">Ù…Ù†ØµØ© ØªÙˆØ§ØµÙ„ Ø¢Ù…Ù†</strong></div>
                </div>
                <div class="user-info">
                    <div class="user-id" id="userIdDisplay"></div>
                    <div style="color: #666; font-size: 14px; margin-bottom: 5px;">
                        <strong id="userNameDisplay"></strong> - <span id="userGradeDisplay"></span>
                    </div>
                    <button class="btn-logout" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
                </div>
            </div>
            
            <div class="welcome-banner">
                <h1>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ù†ØµØ© ØªÙˆØ§ØµÙ„ Ø¢Ù…Ù†! ğŸ‘‹</h1>
                <p>Ù†Ø­Ù† Ù‡Ù†Ø§ Ù„Ø¯Ø¹Ù…Ùƒ. Ù„Ø§ ØªØªØ±Ø¯Ø¯ ÙÙŠ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª.</p>
            </div>
            
            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('dashboard')">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
                <button class="tab-btn" onclick="switchTab('privacy')">ğŸ”’ Ø§Ù„Ø®ØµÙˆØµÙŠØ©</button>
            </div>
            
            <div id="tabDashboard" class="tab-content active">
                <div class="dashboard-grid">
                    <div class="card">
                        <h2>âš¡ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h2>
                        <button class="action-btn" onclick="openReportModal()">
                            <div class="action-icon">ğŸ“</div>
                            <div style="text-align: right;">
                                <div style="font-weight: 700; font-size: 18px;">ØªÙ‚Ø¯ÙŠÙ… Ø¨Ù„Ø§Øº Ø¬Ø¯ÙŠØ¯</div>
                                <div style="font-size: 14px; opacity: 0.9;">Ø£Ø¨Ù„Øº Ø¹Ù† Ø£ÙŠ Ù…Ø´ÙƒÙ„Ø© Ø¨Ø³Ø±ÙŠØ© ØªØ§Ù…Ø©</div>
                            </div>
                        </button>
                        
                        <button class="action-btn" style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);" onclick="alert('ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø·ÙˆØ§Ø±Ø¦:\nğŸš¨ Ø§Ù„Ø´Ø±Ø·Ø©: 911\nğŸ“ Ù…Ø±ÙƒØ² Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª: 1919\nğŸ›ï¸ ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªÙ†Ù…ÙŠØ©: 19911')">
                            <div class="action-icon">ğŸš¨</div>
                            <div style="text-align: right;">
                                <div style="font-weight: 700; font-size: 18px;">Ø­Ø§Ù„Ø© Ø·ÙˆØ§Ø±Ø¦</div>
                                <div style="font-size: 14px; opacity: 0.9;">Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ø³Ù…ÙŠØ©</div>
                            </div>
                        </button>
                    </div>
                    
                    <div class="card">
                        <h2>ğŸ“‹ Ø¨Ù„Ø§ØºØ§ØªÙŠ</h2>
                        <div id="reportsList"></div>
                    </div>
                </div>
            </div>
            
            <div id="tabPrivacy" class="tab-content">
                <div class="card">
                    <h2>ğŸ”’ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®ØµÙˆØµÙŠØ©</h2>
                    <div class="privacy-notice">
                        <h3>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø³Ø§Ø¨Ùƒ</h3>
                        <p><strong>Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</strong> <span id="privacyStudentId"></span></p>
                        <p><strong>ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±:</strong> <span id="privacyGuardianName"></span></p>
                        <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©:</strong> <span id="privacyConsentDate"></span></p>
                        <p><strong>Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©:</strong> <span style="color: #20bf6b; font-weight: 700;">âœ“ Ù†Ø´Ø·</span></p>
                    </div>
                    
                    <div class="consent-box">
                        <h3>Ø­Ù‚ÙˆÙ‚Ùƒ</h3>
                        <ul>
                            <li>Ø§Ù„Ø­Ù‚ ÙÙŠ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ</li>
                            <li>Ø§Ù„Ø­Ù‚ ÙÙŠ ØªØµØ­ÙŠØ­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</li>
                            <li>Ø§Ù„Ø­Ù‚ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø§ØªØµÙ„ Ø¨Ø§Ù„Ù…Ø±Ø´Ø¯)</li>
                            <li>Ø§Ù„Ø­Ù‚ ÙÙŠ Ø³Ø­Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</li>
                        </ul>
                        <button class="btn-submit" style="margin-top: 20px; background: #6c757d;" onclick="alert('Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø¹Ù† Ø§Ù„Ø®ØµÙˆØµÙŠØ©:\nØ§ØªØµÙ„ Ø¨Ø§Ù„Ù…Ø±Ø´Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ\nØ£Ùˆ Ø±Ø§Ø³Ù„: privacy@studentcare.sa')">Ø·Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø¨ÙŠØ§Ù†Ø§ØªÙŠ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Ø§Ù„Ø¨Ù„Ø§Øº -->
    <div id="reportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ“ ØªÙ‚Ø¯ÙŠÙ… Ø¨Ù„Ø§Øº Ø¬Ø¯ÙŠØ¯</h2>
                <button class="btn-close" onclick="closeReportModal()">Ã—</button>
            </div>
            
            <div class="alert-box">
                <strong>ğŸ”’ Ø³Ø±ÙŠØ© ØªØ§Ù…Ø©</strong>
                Ø¬Ù…ÙŠØ¹ Ø¨Ù„Ø§ØºØ§ØªÙƒ Ù…Ø­Ù…ÙŠØ© ÙˆÙ…Ø´ÙØ±Ø©. Ù„Ù† ÙŠØ·Ù„Ø¹ Ø¹Ù„ÙŠÙ‡Ø§ Ø¥Ù„Ø§ Ø§Ù„Ù…Ø±Ø´Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯.
            </div>
            
            <form id="reportForm">
                <div class="form-group">
                    <label>Ù†ÙˆØ¹ Ø§Ù„Ø¨Ù„Ø§Øº *</label>
                    <select id="reportType" required>
                        <option value="">-- Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¨Ù„Ø§Øº --</option>
                        <option value="ØªÙ†Ù…Ø±">ğŸš¨ ØªÙ†Ù…Ø± (Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ©)</option>
                        <option value="ØªØ­Ø±Ø´">âš ï¸ ØªØ­Ø±Ø´ (Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ© - ØªØµØ¹ÙŠØ¯ ÙÙˆØ±ÙŠ)</option>
                        <option value="Ø¹Ù†Ù">ğŸ’¥ Ø¹Ù†Ù (Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ© - ØªØµØ¹ÙŠØ¯ ÙÙˆØ±ÙŠ)</option>
                        <option value="Ù…Ø´ÙƒÙ„Ø© Ø£Ø³Ø±ÙŠØ©">ğŸ  Ù…Ø´ÙƒÙ„Ø© Ø£Ø³Ø±ÙŠØ©</option>
                        <option value="ÙÙ‚Ø±">ğŸ’° Ù…Ø´ÙƒÙ„Ø© Ù…Ø§Ù„ÙŠØ©</option>
                        <option value="Ù‚Ù„Ù‚ Ù†ÙØ³ÙŠ">ğŸ˜Ÿ Ù‚Ù„Ù‚ Ù†ÙØ³ÙŠ</option>
                        <option value="Ø§ÙƒØªØ¦Ø§Ø¨">ğŸ˜” Ø§ÙƒØªØ¦Ø§Ø¨ (Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ©)</option>
                        <option value="Ù…Ø´ÙƒÙ„Ø© Ø¯Ø±Ø§Ø³ÙŠØ©">ğŸ“š Ù…Ø´ÙƒÙ„Ø© Ø¯Ø±Ø§Ø³ÙŠØ©</option>
                        <option value="Ø£Ø®Ø±Ù‰">ğŸ“Œ Ø£Ø®Ø±Ù‰</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¨Ù„Ø§Øº *</label>
                    <input type="text" id="reportTitle" placeholder="Ù…Ø«Ø§Ù„: Ø£Ø­ØªØ§Ø¬ Ù…Ø³Ø§Ø¹Ø¯Ø©" required>
                </div>
                
                <div class="form-group">
                    <label>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¨Ù„Ø§Øº *</label>
                    <textarea id="reportDescription" placeholder="Ø§Ø´Ø±Ø­ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¨Ø§Ù„ØªÙØµÙŠÙ„... ÙƒÙ„ Ù…Ø§ ØªÙƒØªØ¨Ù‡ Ø³ÙŠØ¨Ù‚Ù‰ Ø³Ø±ÙŠØ§Ù‹ ÙˆÙ…Ø´ÙØ±Ø§Ù‹" required></textarea>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="isAnonymous">
                    <label for="isAnonymous">Ø£Ø±ÙŠØ¯ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¨Ø´ÙƒÙ„ Ù…Ø¬Ù‡ÙˆÙ„ (Ù„Ù† ØªØ¸Ù‡Ø± Ù‡ÙˆÙŠØªÙŠ Ù„Ù„Ù…Ø±Ø´Ø¯)</label>
                </div>
                
                <div class="emergency-notice" id="emergencyWarning" style="display: none;">
                    <h4>âš ï¸ ØªÙ†Ø¨ÙŠÙ‡: Ø­Ø§Ù„Ø© Ø·Ø§Ø±Ø¦Ø©</h4>
                    <p>Ù‡Ø°Ø§ Ø§Ù„Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª Ø³ÙŠØªÙ… ØªØµØ¹ÙŠØ¯Ù‡ ÙÙˆØ±Ø§Ù‹ Ù„Ù„Ù…Ø±Ø´Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠØŒ ÙˆÙ‚Ø¯ ÙŠØªØ·Ù„Ø¨ Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø±Ø³Ù…ÙŠØ© (Ø§Ù„Ø´Ø±Ø·Ø©ØŒ Ù…Ø±ÙƒØ² Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª) Ù„Ø­Ù…Ø§ÙŠØªÙƒ.</p>
                </div>
                
                <button type="submit" class="btn-submit">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ù„Ø§Øº</button>
            </form>
        </div>
    </div>
    
    <script>
        let userData = JSON.parse(localStorage.getItem('studentData')) || null;
        let reports = JSON.parse(localStorage.getItem('studentReports')) || [];
        let currentStep = 1;
        
        // Ø¹Ø±Ø¶ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ
        document.getElementById('consentDate') && (document.getElementById('consentDate').textContent = new Date().toLocaleDateString('ar-SA'));
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        if (userData && userData.consentGiven) {
            showDashboard();
        }
        
        // Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨
        document.getElementById('studentInfoForm').addEventListener('submit', (e) => {
            e.preventDefault();
            nextStep(1);
        });
        
        // Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
        document.getElementById('guardianInfoForm').addEventListener('submit', (e) => {
            e.preventDefault();
            nextStep(2);
        });
        
        // Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
        document.getElementById('finalConsentForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const signature = document.getElementById('guardianSignature').value;
            const guardianName = document.getElementById('guardianName').value;
            
            if (signature.toLowerCase() !== guardianName.toLowerCase()) {
                alert('âŒ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ·Ø§Ø¨Ù‚ Ø§Ø³Ù… ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± Ø¨Ø§Ù„Ø¶Ø¨Ø·');
                return;
            }
            
            const userId = 'ST' + Date.now().toString().slice(-8);
            
            userData = {
                id: userId,
                studentName: document.getElementById('studentName').value,
                studentId: document.getElementById('studentId').value,
                grade: document.getElementById('grade').value,
                guardianName: guardianName,
                guardianId: document.getElementById('guardianId').value,
                guardianPhone: document.getElementById('guardianPhone').value,
                guardianEmail: document.getElementById('guardianEmail').value,
                guardianRelation: document.getElementById('guardianRelation').value,
                guardianSignature: signature,
                consentDate: new Date().toISOString(),
                consentGiven: true,
                registeredAt: new Date().toISOString()
            };
            
            localStorage.setItem('studentData', JSON.stringify(userData));
            
            // ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚
            logAudit('REGISTRATION', `Student registered: ${userId} with guardian consent`);
            
            alert('âœ… ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨: ' + userId + '\n\nØ§Ø­ØªÙØ¸ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… Ù„Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.\n\nØªÙ… ØªÙˆØ«ÙŠÙ‚ Ù…ÙˆØ§ÙÙ‚Ø© ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø± Ø¨ØªØ§Ø±ÙŠØ®: ' + new Date().toLocaleDateString('ar-SA'));
            
            showDashboard();
        });
        
        function nextStep(step) {
            if (step === 1) {
                document.getElementById('studentInfoForm').style.display = 'none';
                document.getElementById('guardianInfoForm').style.display = 'block';
                document.getElementById('step1').classList.add('completed');
                document.getElementById('step2').classList.add('active');
                currentStep = 2;
            } else if (step === 2) {
                document.getElementById('guardianInfoForm').style.display = 'none';
                document.getElementById('consentForm').style.display = 'block';
                document.getElementById('step2').classList.add('completed');
                document.getElementById('step3').classList.add('active');
                currentStep = 3;
            }
        }
        
        function prevStep(step) {
            if (step === 1) {
                document.getElementById('guardianInfoForm').style.display = 'none';
                document.getElementById('studentInfoForm').style.display = 'block';
                document.getElementById('step2').classList.remove('active');
                document.getElementById('step1').classList.remove('completed');
                currentStep = 1;
            } else if (step === 2) {
                document.getElementById('consentForm').style.display = 'none';
                document.getElementById('guardianInfoForm').style.display = 'block';
                document.getElementById('step3').classList.remove('active');
                document.getElementById('step2').classList.remove('completed');
                currentStep = 2;
            }
        }
        
        function showFullPrivacy() {
            alert('Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©\n\n' +
                  '1. Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„Ø©: ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… - Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©\n\n' +
                  '2. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¬Ù…Ø¹Ø©:\n' +
                  '   - Ø¨ÙŠØ§Ù†Ø§Øª Ø´Ø®ØµÙŠØ©: Ø§Ù„Ø§Ø³Ù…ØŒ Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©ØŒ Ø§Ù„ØµÙØŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„\n' +
                  '   - Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø³Ø©: Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª Ø§Ù„Ø³Ù„ÙˆÙƒÙŠØ© ÙˆØ§Ù„Ù†ÙØ³ÙŠØ©\n\n' +
                  '3. Ø§Ù„ØºØ±Ø¶: Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØªÙˆÙÙŠØ± Ø¨ÙŠØ¦Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¢Ù…Ù†Ø©\n\n' +
                  '4. Ù…Ø¯Ø© Ø§Ù„Ø§Ø­ØªÙØ§Ø¸: Ø·ÙˆØ§Ù„ ÙØªØ±Ø© Ø§Ù„Ø¯Ø±Ø§Ø³Ø© + 3 Ø³Ù†ÙˆØ§Øª\n\n' +
                  '5. Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©: Ø§Ù„Ù…Ø±Ø´Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ ÙÙ‚Ø·\n\n' +
                  '6. Ø§Ù„Ø£Ù…Ø§Ù†: ØªØ´ÙÙŠØ± ÙƒØ§Ù…Ù„ ÙˆÙÙ‚ Ù…Ø¹Ø§ÙŠÙŠØ± SDAIA\n\n' +
                  '7. Ø­Ù‚ÙˆÙ‚Ùƒ: Ø§Ù„ÙˆØµÙˆÙ„ØŒ Ø§Ù„ØªØµØ­ÙŠØ­ØŒ Ø§Ù„Ø­Ø°ÙØŒ Ø§Ù„Ø´ÙƒÙˆÙ‰\n\n' +
                  '8. Ø§Ù„Ø§ØªØµØ§Ù„: privacy@studentcare.sa');
        }
        
        function showDashboard() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('dashboardSection').style.display = 'block';
            
            document.getElementById('userIdDisplay').textContent = 'Ø±Ù‚Ù…Ùƒ: ' + userData.id;
            document.getElementById('userNameDisplay').textContent = userData.studentName;
            document.getElementById('userGradeDisplay').textContent = userData.grade;
            
            document.getElementById('privacyStudentId').textContent = userData.id;
            document.getElementById('privacyGuardianName').textContent = userData.guardianName;
            document.getElementById('privacyConsentDate').textContent = new Date(userData.consentDate).toLocaleDateString('ar-SA');
            
            loadReports();
        }
        
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            
            if (tabName === 'dashboard') {
                document.getElementById('tabDashboard').classList.add('active');
                event.target.classList.add('active');
            } else if (tabName === 'privacy') {
                document.getElementById('tabPrivacy').classList.add('active');
                event.target.classList.add('active');
            }
        }
        
        function loadReports() {
            const reportsList = document.getElementById('reportsList');
            
            if (reports.length === 0) {
                reportsList.innerHTML = '<div class="empty-state"><div style="font-size: 60px;">ğŸ“­</div><p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ù„Ø§ØºØ§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</p></div>';
                return;
            }
            
            reportsList.innerHTML = reports.map(report => `
                <div class="report-item">
                    <div class="report-header">
                        <strong>${report.title}</strong>
                        <span class="report-badge badge-${report.status === 'Ø¬Ø¯ÙŠØ¯' ? 'new' : report.status === 'Ù‚ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©' ? 'progress' : 'resolved'}">
                            ${report.status}
                        </span>
                    </div>
                    <div style="font-size: 14px; color: #666;">
                        ğŸ“Œ ${report.type} | ğŸ• ${new Date(report.date).toLocaleDateString('ar')} | ${report.priority}
                        ${report.escalated ? '<br>ğŸš¨ ØªÙ… Ø§Ù„ØªØµØ¹ÙŠØ¯ Ù„Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ù…Ø®ØªØµØ©' : ''}
                    </div>
                </div>
            `).join('');
        }
        
        function openReportModal() {
            document.getElementById('reportModal').classList.add('active');
        }
        
        function closeReportModal() {
            document.getElementById('reportModal').classList.remove('active');
            document.getElementById('reportForm').reset();
            document.getElementById('emergencyWarning').style.display = 'none';
        }
        
        // ØªØ­Ø°ÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø·Ø§Ø±Ø¦Ø©
        document.getElementById('reportType').addEventListener('change', (e) => {
            const emergencyTypes = ['ØªØ­Ø±Ø´', 'Ø¹Ù†Ù', 'Ø§ÙƒØªØ¦Ø§Ø¨'];
            const warning = document.getElementById('emergencyWarning');
            
            if (emergencyTypes.includes(e.target.value)) {
                warning.style.display = 'block';
            } else {
                warning.style.display = 'none';
            }
        });
        
        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ù„Ø§Øº
        document.getElementById('reportForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const reportType = document.getElementById('reportType').value;
            const emergencyTypes = ['ØªØ­Ø±Ø´', 'Ø¹Ù†Ù'];
            const isEmergency = emergencyTypes.includes(reportType);
            
            const reportData = {
                id: 'RPT' + Date.now(),
                studentId: userData.id,
                studentName: document.getElementById('isAnonymous').checked ? 'Ù…Ø¬Ù‡ÙˆÙ„' : userData.studentName,
                type: reportType,
                title: document.getElementById('reportTitle').value,
                description: document.getElementById('reportDescription').value,
                isAnonymous: document.getElementById('isAnonymous').checked,
                status: 'Ø¬Ø¯ÙŠØ¯',
                priority: ['ØªÙ†Ù…Ø±', 'ØªØ­Ø±Ø´', 'Ø¹Ù†Ù', 'Ø§ÙƒØªØ¦Ø§Ø¨'].includes(reportType) ? 'Ø¹Ø§Ù„ÙŠ' : 'Ù…ØªÙˆØ³Ø·',
                date: new Date().toISOString(),
                escalated: isEmergency,
                counselorNotes: ''
            };
            
            reports.push(reportData);
            localStorage.setItem('studentReports', JSON.stringify(reports));
            
            let allReports = JSON.parse(localStorage.getItem('allReports')) || [];
            allReports.push(reportData);
            localStorage.setItem('allReports', JSON.stringify(allReports));
            
            // ØªØ³Ø¬ÙŠÙ„ ÙÙŠ Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚
            logAudit('REPORT_CREATED', `Report ${reportData.id} created by ${userData.id} - Type: ${reportType} - Priority: ${reportData.priority}`);
            
            if (isEmergency) {
                logAudit('EMERGENCY_ESCALATION', `URGENT: Report ${reportData.id} escalated - Type: ${reportType} - Student: ${userData.id}`);
                alert('ğŸš¨ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ù„Ø§Øº ÙˆØªØµØ¹ÙŠØ¯Ù‡ ÙÙˆØ±Ø§Ù‹!\n\nÙ†ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„Ø©: ' + reportType + '\n\nØªÙ… Ø¥Ø´Ø¹Ø§Ø±:\nâœ“ Ø§Ù„Ù…Ø±Ø´Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ\nâœ“ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø±Ø³Ø©\n' + 
                      (reportType === 'ØªØ­Ø±Ø´' || reportType === 'Ø¹Ù†Ù' ? 'âœ“ Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ© Ø§Ù„Ù…Ø®ØªØµØ©\n' : '') +
                      '\nØ³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©.\n\nÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±:\nğŸš¨ Ø§Ù„Ø´Ø±Ø·Ø©: 911\nğŸ“ Ù…Ø±ÙƒØ² Ø§Ù„Ø¨Ù„Ø§ØºØ§Øª: 1919');
            } else {
                alert('âœ“ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ù„Ø§Øº Ø¨Ù†Ø¬Ø§Ø­!\n\nØ³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹ØªÙ‡ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ù…Ø±Ø´Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠ ÙˆØ§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹.\n\nØ¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ø­Ù…ÙŠØ© ÙˆÙ…Ø´ÙØ±Ø©.');
            }
            
            closeReportModal();
            loadReports();
        });
        
        function logout() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
                logAudit('LOGOUT', `Student ${userData.id} logged out`);
                location.reload();
            }
        }
        
        // Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚ (Audit Log)
        function logAudit(action, details) {
            let auditLog = JSON.parse(localStorage.getItem('auditLog')) || [];
            auditLog.push({
                timestamp: new Date().toISOString(),
                action: action,
                details: details,
                userId: userData ? userData.id : 'ANONYMOUS',
                ip: 'LOCAL' // ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø³ÙŠØªÙ… Ø¬Ù„Ø¨ IP Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
            });
            localStorage.setItem('auditLog', JSON.stringify(auditLog));
        }
    </script>
</body>
</html>
